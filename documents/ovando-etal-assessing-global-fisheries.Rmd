---
title: Status of Global Unassessed Fisheries will Remain Highly Uncertain without Better Data
author: 
  - Daniel Ovando
  - Ray Hilborn
  - Cole Monnahan
  - Merrill Rudd
  - Rishi Sharma
  - James Thorson
  - Yannick Rousseau
  - Yimin Ye
date: "`r Sys.Date()`"
bibliography: ["../references.bib"]
csl: fish-and-fisheries.csl
output: 
  bookdown::pdf_document2:
    latex_engine: xelatex
  bookdown::word_document2:
    reference_docx: template.docx
params:
  results_name: ["v1.0"]
  min_years_catch: [25]
abstract: |
  Assessments of the global state of fish populations play a critical role in tracking the implementation of the United Nations Sustainable Development Goals. While we have reliable estimates of stock status for fish populations accounting for approximately half of recent global catch, our knowledge of the state of the majority of the word's 'unassessed' fish stocks remains highly uncertain. Numerous publications have produced estimates of the global status of these unassessed fisheries, but limited quantity and quality of data along with methodological differences have produced counterintuitive and conflicting results. Here, we show that despite numerous efforts, our understanding of the status of global fish stocks remains incomplete, even when new sources of broadly available data are added. Estimates of fish populations based primarily on catch histories alone on average performed 29% better than a random guess. But, on average these methods assigned fisheries to the wrong FAO status category 57% of the time. Obtaining accurate estimates of stock status for the world's exploited fish populations depends on prioritizing the collection of high-priority data around the globe, rather than the development of new modeling methods alone.
always_allow_html: true
linkcolor: blue
header-includes:
  - \usepackage{setspace}\doublespacing
  - \usepackage{lineno}\linenumbers
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, dpi = 600,
                      cache = FALSE, fig.width = 6, fig.asp = .75, dev = "png")
library(tidyverse)
library(viridis)
library(sf)
library(hrbrthemes)
library(extrafont)
library(scales)
library(patchwork)
library(rstanarm)
library(bayesplot)
library(here)
library(sraplus)
extrafont::loadfonts()

functions <- list.files(here::here("functions"))

purrr::walk(functions, ~ source(here::here("functions", .x)))

results_name <- params$results_name

results_path <- here("results",results_name)

min_years_catch <- params$min_years_catch

prepare_sofia_data(lookup_fmi_names = FALSE)

ram_comp_data <- ram_data %>%
  mutate(has_things = !(is.na(catch) | catch == 0)) %>%
  filter(has_things) %>%
  group_by(stockid) %>%
  mutate(delta_year = as.integer(year - lag(year))) %>%
  mutate(delta_year = case_when(year == min(year) ~ as.integer(1),
                                TRUE ~ delta_year)) %>%
  mutate(missing_gaps = any(delta_year > 1)) %>%
  filter(missing_gaps == FALSE) %>%
  group_by(stockid) %>%
  mutate(n = length(catch)) %>%
  filter(n >= min_years_catch) %>%
  ungroup()

ram_comp_data <- ram_comp_data %>%
  select(
    year,
    stockid,
    country,
    primary_FAOarea,
    scientificname,
    commonname,
    year,
    catch,
    b_v_bmsy,
    u_v_umsy,
    total_biomass
  ) %>%
  rename(scientific_name = scientificname) %>% 
  mutate(fao_area_code = as.numeric(primary_FAOarea)) %>% 
  left_join(fao_species, by = "scientific_name")


assess_ram_fits <- read_rds(path = file.path(results_path,"assess_ram_fits.rds"))

ram_v_sraplus_area <- read_rds(path = file.path(results_path,"ram_v_sraplus_area.rds"))

ram_comp_data <- read_rds(path = file.path(results_path,"ram_comp_data.rds"))

fao_sraplus_comp_data <- read_rds(path = file.path(results_path, "fao_sraplus_comp_data.rds"))


load(file = file.path(results_path, "paper_plots.Rdata"))

load(file = file.path(results_path, "voi_fits.RData"))

  exs <- read_rds(path = file.path(results_path, "raw-case-study-fits.rds"))


breaks <- c(0.8, 1.2)

breaks <- c(0, breaks, Inf)

labels <- c("over", "fully", "under")


# rand_fits <- assess_ram_fits %>%
#   filter(data == "ram-data") %>%
#   mutate(mean = sample(c(0.1, 1, 2), n(), replace = TRUE),
#          data = "guess")


perf <- assess_ram_fits %>% 
  # bind_rows(rand_fits) %>% 
  mutate(sraplus_bin = cut(mean, breaks = breaks, labels = labels)) %>%
  mutate(ram_bin = cut(ram_b_v_bmsy, breaks = breaks, labels = labels)) %>%
  mutate(data = as.factor(data)) %>% 
  filter(data != "u_umsy") %>% 
  mutate(data = forcats::fct_recode(data, 
                                    "RAM Index" = "ram-data",
                                    "SAR" = "sar",
                                    "FMI" = "fmi",
                                    "Effective CPUE" = "cpue",
                                    "Effective CPUE+" = "cpue-plus",
                                    "Nominal CPUE" = "nominal-cpue",
                                    "Nominal CPUE+" ="nominal-cpue-plus",
                                    "CMSY" = "cmsy",
                                    "Guess" = "guess",
                                    "RAM F/Fmsy" = "u_umsy"
                                     
                                    )) %>% 
  group_by(data) %>% 
  summarise(
    mpe = median((mean - ram_b_v_bmsy ) / ram_b_v_bmsy),
    mape = median(abs(mean - ram_b_v_bmsy ) / ram_b_v_bmsy),
    accuracy = mean(ram_bin == sraplus_bin, na.rm = TRUE)
  ) %>% 
  arrange((mape)) %>% 
  rename("Data Used" = "data")



fao_area_codes <- fao %>% 
  ungroup() %>% 
  select(fao_area, fao_area_code) %>% 
  unique()



pub_theme <- theme_ipsum(base_size = 10,
                         axis_text_size = 10,
                         axis_title_size = 12) +
    theme(panel.spacing = unit(.5,"lines"))

theme_set(pub_theme)


```

<!-- data limited are not just messier versions of data rich  -->

<!-- 80% in trouble  -->

<!-- # rishi notes -->

<!-- * more assertive on what the data needs really are -->

<!--   * where to apply globally  -->

<!-- * For places with less coverage, what would we actually recommend there  -->

<!-- * what do we know about catchabiliy -->

<!-- - e.g. 51, fleets became industrial  -->

<!--   - hammer down on that's the issue with the effort  -->

<!--   - how do we translate effort into f bey area -->

<!--   - here's  -->

<!-- https://www.nature.com/natsustain/about/content -->

<!-- # check in call notes -->

<!-- Ray: setting the stage: what we want is a way to assess the status of stocks and see how we're doing relative to SDG. -->

<!-- We need to discuss a sampling strategy: how can we get down to a set of priority stock. A step of expert knowledge to refine what stocks you would focus in on. -->

<!-- Regressions based approach, focusing in effort on stocks -->

<!-- Basically a paragraph laying out that we need to do this, and discussing how we might go about doing that. Equal weight to each stock vs proportional to biomass -->

<!-- add in a bit more to the discussion on guidelines -->

<!-- add in error in the index for the VOI analysis -->

<!-- Apples and apples comparisons between model and design developments. How much is the value of the effort data relative to actually improving the population model. Production model is ill-suited to some of these questions. -->

<!-- fishing effort uncertainty of the effort -->

<!-- how credible is the information -->

<!-- probably don't need to bother with the SAUP -->

<!-- stock assessments -->

<!-- the stock will collapse next year -->

<!-- nansen data -->

<!-- # Publication Requirements -->

<!-- Target Journal: [Nature Sustainability](https://www.nature.com/natsustain/about/content) -->

<!-- 3500 words main text -->

<!-- 50 references (main text) -->

<!-- 3000 words (max) methods -->

<!-- # Significance Statement  {.unnumbered} -->

<!-- <!-- Authors must submit a 120-word-maximum statement about the significance of their research paper written at a level understandable to an undergraduate-educated scientist outside their field of specialty. The primary goal of the Significance Statement is to explain the relevance of the work in broad context to a broad readership. --> 

<!-- The health of ocean ecosystems and the well-being of millions of people depend on our ability to accurately estimate the state of marine fish populations. However, these assessments typically require extensive amounts of high-quality data that are not available for large numbers of fisheries that are critical sources of economic and nutritional benefits. Many studies have tried to estimate the state of these unassessed fisheries based solely on the history of catches reported for a fishery, but we show here that these catch-based estimates produce unreliable results. We demonstrate that improving our understanding of global fisheries will depend on redoubled efforts at data collection and capacity building.  -->

\newpage
# Introduction {.unnumbered}

The United Nations Sustainable Development Goal 14 (SDG 14), focusing on "Life under water", calls for the global community to "Conserve and sustainably use the oceans, seas and marine resources for sustainable development". Marine fisheries are one of the largest anthropogenic impacts in the oceans aside from the effects of climate change. When managed sustainably fisheries are a critical source of economic prosperity and food security around the globe. As such, meeting the SDG 14 targets depends in part on our ability to effectively measure the status of global marine fish populations and fisheries. While our understanding of the state of world fisheries has improved over the last decade, the majority of the world's fish populations, making up roughly 50% of marine landings, lack formal statistical assessments (stock assessments) of their population size relative to reference points [@hilborn2020; @fao2020]. This is a major impediment to ensuring the sustainable development of the world's oceans. In this paper, we consider why the assessment of global fisheries remains a challenge, and chart a path towards a better understanding of the state of the world's marine resources.

What do we currently know about the state of fished marine species around the world? The Food and Agriculture Organization of the United Nations' (FAO) is the custodian agency of the SDG 14 Indicator on fisheries sustainability, and the FAO's State of World Fisheries and Aquaculture (SOFIA) report is the most widely used primary source for tracking the global state of fisheries. The latest SOFIA report, covering 70% of the landings of all fisheries in the world, estimates that as of 2017 59.6% of marine fish stocks are maximally sustainably fished (at or near targets for sustainable food production), 6.2% are underfished, and 34.2% are overfished [@fao2020]. Where possible, these statements about the status of individual fish stocks are made on the basis of formal stock assessments reported in the RAM Legacy Stock Assessment Database (RAM) [@ricard2012]. The "assessed" fisheries in RAM represent roughly 50% of global capture as of 2020 [@hilborn2020], and represent our best estimates of the state of assessed fish populations around the globe. 

That leaves roughly 50% of global landings, and the majority of global fisheries, as currently "unassessed". While these unassessed stocks are generally individually smaller and less economically valuable than the fish populations in the assessed category, collectively they are a vital source of food, employment, cultural value, and ecosystem services around the world. The SOFIA report includes unassessed stocks and bases its estimates for these fisheries on data-limited methods or qualitative expert opinion for each region where these stocks are distributed [@fao2020]. While these methods combined with local knowledge can provide good insight as to the general status of unassessed fish stocks, the SOFIA assessment was designed in the 1970s based on the then available data and methods. With the surge in data availability, such as global assessments of management strength, trawl footprints, and fishing effort, the SOFIA global assessment methods for unassessed fish populations need to be updated to meet the demand for tracking progress of global fish populations towards the SDG goals. In addition, the SOFIA process assigns unassessed fisheries to broad categories of stock status, while many stakeholders seek information on more specific values such as biomass relative to to the biomass that would on average result in maximized yield over the long-term. 

<!-- We evaluate the ability of alternative assessment models to improve our estimate of the population status of unassessed fish stocks around the world.  -->

Numerous studies in recent years have put forward versions of "data-limited" models that have attempted to provide numerical estimates of the global status of unassessed fish stocks lacking the data or capacity needed for formal stock assessment [@costello2012b; @costello2016a; @pauly2007; @rosenberg2018; @thorson2012a]. Due to data limitations, all of these global assessment efforts have used forms of "catch-only" data-limited models (@free2020 and references therein). These models seek to infer the state of a fished population, for example biomass (*B*) relative to the biomass at maximum sustainable yield (*B~MSY~*, the ratio *B/B~MSY~* being our measure of stock status), from characteristics of a fishery's catch history, and have been the foundation of many subsequent analyses of the future of global fisheries (e.g.  @cabral2020 and @gaines2018).



<!-- These issues become apparent when we consider some of the macro-level predictions made by these models. While the estimates of *B/B~MSY~* and other reference points reported in RAM are themselves model outputs subject to their own non-trivial errors and biases, a simple benchmark is to compare the estimates of fishery status from RAM to those predicted by catch-only models intended for use when insufficient data are available for a full stock assessment model. -->

<!-- @costello2016a found similar rankings of regions in terms of stock status as RAM, but their estimate of the state of fisheries in the Mediterranean/Black Sea regions and Southeast Asia seems to be overly-optimistic, and the Northeast Pacific should be better by comparison. The superensemble method [@anderson2017a] used in @rosenberg2018 demonstrates the same problem, with stocks in Southeast Asia estimated as doing better than the Northeast Atlantic or Northeast Pacific. Simply comparing catch divided by maximum catch, in the manner of @pauly2007, finds the stocks of Southeast Asia in much better condition than those in the Northeast Pacific or Northeast Atlantic (Table.\@ref(tab:status-tab)). The non-RAM results in Table.\@ref(tab:status-tab) include both formally assessed and unassessed stocks, and as such we would expect them to differ broadly in their estimates of regional stock status, particularly since we might expect unassessed stocks to be less rigorously managed and by extension have poorer stock status. However, the lack of consistency across heavily assessed regions such as the Northeast Pacific, and the lack of contrast in stock status between heavily and lightly exploited regions as measured by RAM and the FAO resulting from these catch-only efforts at assessing global fisheries is concerning. -->

```{r status-tab, include=FALSE}

o_by_a <- sofia_status %>% 
  left_join(fao_area_codes, by = "fao_area_code") %>% 
  group_by(fao_area) %>% 
  summarise(`FAO % Overfished` = percent(mean(status == "O")))

ss <-
  readxl::read_xlsx(here("data", "state_space_results_08_28_2018 by region.xlsx"),
                    sheet = "state_space_results_08_28_2018") %>%
  janitor::clean_names()


ss_lookup <-
  readxl::read_xlsx(here("data", "state_space_results_08_28_2018 by region.xlsx"),
                    sheet = "ss_to_fao") %>%
  janitor::clean_names() %>% 
  mutate(tmp = map2(region, fao_area_codes, ~data.frame(region = .x, fao_area_code = as.integer(str_split(.y, pattern = ',',simplify = TRUE))))) %>% 
  select(tmp) %>% 
  unnest(cols = tmp) %>% 
    left_join(fao_area_codes, by = "fao_area_code")

state_space_results <- ss_lookup %>% 
  left_join(ss, by = "region") %>% 
  filter(variable == "BvB") %>% 
  group_by(fao_area) %>% 
  filter(year == max(year)) %>% 
  summarise(`B/BMSY RAM` = round(mean(dlm_geomean),2)) %>% 
  ungroup() 


# ram_by_region %>% 
#   ggplot(aes(b_v_bmsy)) +
#   geom_histogram() + 
#   facet_wrap(~fao_area)


tmp <- readr::read_csv(here("data","status-table.csv")) %>% 
  select(-`B/BMSY RAM`) %>%  
  left_join(o_by_a, by = c("FAO Area" = "fao_area")) %>% 
  left_join(state_space_results, by = c("FAO Area" = "fao_area")) %>% 
  arrange(`FAO % Overfished`) %>% 
    rename(`SOFIA % Overfished` = `FAO % Overfished`) %>% 
  select(`FAO Area`,`SOFIA % Overfished`,`B/BMSY RAM`, everything()) 

 tmp %>% 
  knitr::kable(caption = "Estimates of fish stock status by FAO, RAM Legacy Stock Assessment Database through Hilborn et al. 2020, Costello et al. 2016, 
               Rosenberg et al. 2018, Catch / max(Catch)",
               booktabs = TRUE,
               format = "pipe") %>% 
  kableExtra::kable_styling(full_width = T, font_size = 9) %>%
  kableExtra::row_spec(0, bold = T)
 

```

However, @free2020 demonstrated that the types of catch-only models used in these global assessment efforts can often produce both imprecise and biased estimates of current stock status in terms of *B/B~MSY~*. While each of these prior efforts at assessing global fisheries using catch-only methods made important advances in our understanding of the global oceans, none have proven to be a consistently reliable means of estimating stock status of the individual unassessed fisheries around the world. The types of global assessment efforts share a common underlying assumption; that globally available catch histories contain meaningful information on the state of the fished populations that they came from, and that this information can be revealed by the right model structure. Under this assumption, we can obtain better estimates of the state of unassessed fish populations simply by improving the catch-only models applied to the catch histories from these fisheries. However, further evaluation of the predictions made by these models [@free2020;@bouch2021;@pons2020] as well as works such as @pauly2013 and @branch2011 call into question this very idea. 

In this paper we ask, how much can estimates from catch-only assessments be improved by moving beyond catch-only and augmenting catch histories with additional sources of broadly available fisheries data? We answer this question by aggregating a set of broadly distributed datasets that might be of use to global fishery assessment. We then used our new assessment method, sraplus, to evaluate the performance status estimates derived from different combinations of these broadly available data. Wecompared these results with estimates from the increasingly utilized (e.g. @palomares2020) default settings of the catch-only version of CMSY described in @froese2017. We show that improving our understanding of the world's unassessed fisheries depends on a redoubled effort at global data collection and synthesis, not on incremental improvements to assessment methods based solely on catch histories.

# Methods {.unnumbered}

The key attribute of sraplus is not substantial improvements in model fitting methods per say, but the ability to easily incorporate multiple kinds of fishery data potentially used in SRA style analyses in a statistically rigorous manner. We paired these data with fisheries in RAM, and then used sraplus to generate predictions of B/B~MSY~ in the most recent year of each fishery across different combinations of the data types. We then compared the predictions generated by sraplus using different types of data, along with predictions for the same fisheries generated by CMSY, to the reported values in RAM. 

All analysis were conducted in the R programming language [@rcoreteam2019]. Model fitting was conducted using Rcpp [@eddelbuettel2011] and Stan [@carpenter2017] implemented through Template Model Builder [@kristensen2016] by the tmbstan package [@monnahan2018]. The sraplus package is publicly available at [github.com/danovando/sraplus](https://github.com/DanOvando/sraplus), and all materials needed to fully reproduce this manuscript are available at [github.com/DanOvando/assessing-global-fisheries](https://github.com/DanOvando/assessing-global-fisheries). Here we describe the structure of the population model underpinning sraplus, the estimation models used, and the construction of priors used in this paper.


## Data Sources {.unnumbered}

At its most "data-limited", sraplus can work as a catch-only model in the manner of @froese2017. These catch histories can then be augmented with prior information on stock status derived from increasingly available sources of global fishery data: the Fisheries Management Index (FMI) [@melnychuk2017] and swept area ratio (SAR) [@amoroso2018] databases. The FMI database provides self-reported scores reflecting the strength of fisheries management in many fisheries around the world, which sraplus uses to construct informative priors on stock status, e.g. placing a higher probability that fisheries with high FMI scores have better stock status than those with low FMI scores. SAR is a measure of the intensity of trawl fishing within a particular area, which sraplus uses to construct an informative prior on the magnitude of fishing mortality. While fishery-independent surveys are becoming increasingly available [@maureaud2020], they are not yet sufficiently distributed or accessible to serve as a foundation for global assessments of unassessed fisheries. As an alternative, @rousseau2019b present a global reconstruction of fishing effort for countries around the world. We pair these effort reconstructions (both nominal effort and effective effort assuming an annual rate of efficiency increase of 2.6%) with the FAO's catch histories to construct a catch-per-unit-effort (CPUE) index, which we pass to sraplus along with catch histories and other available data to provide an estimate of stock status. In this way sraplus allows us to move from catch-only models to more conventional surplus production models in the manner of @winker2018 (Table.\@ref(tab:data)). 

+---------------------------------------------+------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+
| Data Source                                 | Short Name       | Data Use                                                                 | Caveats                                                                                                         |
+=============================================+==================+==========================================================================+=================================================================================================================+
| Catch data [@fao2020]                       | catches          | Priors on stock status, scaling of population size, exploitation history | Heuristics or regressions used to translate shape of catch history into priors on stock status                  |
+---------------------------------------------+------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+
| Fisheries Management Index [@melnychuk2017] | FMI              | Priors on most recent F/F~MSY~ values                                    | Priors produced by regression trained on data from RAM Legacy Stock Assessment Database                         |
+---------------------------------------------+------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+
| Swept Area Ratio [@amoroso2018]             | SAR              | Priors on most recent F/F~MSY~ values                                    | Priors produced by regression trained on data from RAM Legacy Stock Assessment Database                         |
+---------------------------------------------+------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+
| Reconstructed effort data [@rousseau2019b]  | effort           | Combined with catch data to create an index of abundance                 | Total reconstructed effort across all sectors. Assumed rate of technology creep reported in individual sections |
+---------------------------------------------+------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+

: (\#tab:data) Data sources included across model fits.

<!-- In this paper we ask, can augmenting the types of catch-only models employed in global assessments to date with new broadly available data improve our understanding of the state of global fish populations? We use a flexible stock assessment software package, [sraplus](www.github.com/danovando/sraplus) to demonstrate how different data sources can be used to augment catch-only models at a global scale, and to evaluate how our perception of global stock status would vary depending on which sources of data we include. -->

<!-- ## Experiment Structure {.unnumbered} -->




<!-- We compared estimates of stock status, defined by *B/B~MSY~* obtained from sraplus using various forms of broadly available data to the best-available estimates of *B/B~MSY~* available for those fish populations reported in the RAM database.  -->

<!-- ## Data Sources {.unnumbered} -->

<!-- We restricted ourselves to databases with wide coverage around the world, representing the types of information that can be leveraged in efforts to assess the status of global fisheries (Table.\@ref(tab:data)).  -->


## Population Model {.unnumbered}


The core of sraplus is a Pella-Tomlinson [@pella1969] production model constructed in the manner of Winker *et al.* 2018 [@winker2018]. While models of these kinds abstract away many important details of fish biology and fleet behavior, they are the highest resolution model that the data types evaluated here will support. The purpose of sraplus is not to make substantial innovations in the fitting of surplus production models, but to provide a flexible tool for exploring the impacts of adding different kinds of data and priors on estimates of fishery status

The population growth equation is

\begin{equation}
f(x)=\begin{cases}
B_{t + 1} = \left(B_{t} + B_{t}\frac{r}{m - 1}\left(1 - \left(\frac{B_t}{K}\right)^{m- 1}\right) - c_t\right)p_t
, & \text{if $B_t>0.25 \times K$}.\\
B_{t + 1} = \left(B_{t} + \frac{B_{t}}{0.25 \times K}\left(B_{t}\frac{r}{m - 1}\left(1 - \left(\frac{B_t}{K}\right)^{m- 1}\right) - c_t\right)\right)p_t, & \text{otherwise}.
\end{cases}
(\#eq:pt)
\end{equation}

Where $B_t$ is biomass at time *t*, *K* is carrying capacity ,*r* is the intrinsic growth rate, *m* is the scaling parameter that allows for the ratio of *B~MSY~/K* to shift. When *m* = 2 *B~MSY~ / K* = 0.5, lower values of *m* shift the production function left, higher values right. The shape parameter *m* is usually not reliably estimable given available data for surplus production models, however, Thorson et al. 2012 [@thorson2012] provides estimate the ratio of *B~MSY~* to *K* for many fish taxa. We fix the shape parameter based on the distributions reported in Thorson et al. 2012 [@thorson2012] for the genus of the species in question.

$\pmb{c}$ is a vector catches, and $\pmb{p}$ is vector of process errors. Growth rates can become unrealistically large when the population reaches low sizes under the Pella-Tomlinson model. We deal with this problem by following the methods described in [@winker2018]. to reduce the production of the population when it falls below a threshold of 25% of carrying capacity.

We allow for process error *p_t* (in the manner of the stochastic stock reduction analysis (SRA) suggested by Walters *et al.* 2006 [@walters2006]). Process error *p_t* is assumed to be log-normally distributed, such that

<!-- This allows the population dynamics to deviate from the exact values given by the Pella-Tomlinson operating model, while still conforming to the assumptions of this model on average. Incorporation of process errors is useful for two reasons: (1) when you have an abundance index, process errors can reduce bias arising from lack of fit in a deterministic SRA whenever dynamics are poorly explained by catch-history alone, and (2) with or without an abundance index (or other info), the stochastic portion is necessary to get good uncertainty intervals (i.e., with close to nominal coverage, see [@thorson2018]). -->

\begin{equation}
  p_t \sim e^{normal\left(-\sigma_{proc}^2/2,\sigma_{proc}\right)}
(\#eq:procerror)
\end{equation}

## Estimation Model {.unnumbered}

All of our estimates are Bayesian in nature. sraplus can be run in two forms: either as a stock reduction analysis [SRA, @walters2006], or fit to an index of abundance (fishery dependent or independent) using Hamiltonian Monte Carlo with the No-U-Turn sampler [@hoffman2011]. Unless there is an abundance index to fit to, the model runs as a stock reduction analysis. A stock reduction analysis works by specifying prior distributions on population parameters and critically the recent state of the fishery. sraplus allows users to specify the most recent status in units of depletion, *B/B~MSY~*, *F*, or *F/F~MSY~*. We then sample from the prior distributions of the population model parameters and apply those to the production model, along with the catch history. Any run that results in the collapse of the population (catch greater than biomass in any time step) is immediately rejected. The remaining viable draws from the prior distributions are sampled in proportion to the supplied prior on recent stock status. All stock reduction analysis runs in our paper sampled 2,000 draws of the prior-predictive distribution from a total of 1e6 candidate draws. For our main sets of results (everything excluding the value of information analysis), the estimated parameters are *r*, *K*, $\sigma_{obs}$, $\gamma$, and *B0*. *q* is also estimated when needed.

<!-- . We can break the use of sraplus into two distinct categories: with data to fit to and without. By "data", we refer to measurements which are used to confront model estimates within a likelihood function. In our context, these include fishery-independent survey data, or a CPUE index. When there are no data to fit to, the model amounts to filtering priors through the model (the combination of the Pella-Tomlinson operating model and the catches for the stock in question, along with any fixed parameters). Under this mode, the model is essentially a stock-reduction analysis model, in the manner of [@walters2006], in which we ask, which combinations of prior probability distributions of parameters do not crash the population (i.e. results in biomass less than catches in any time step in the fishery's history), given the constraints of the population model and the catches. This step updates the prior distribution of population parameters by eliminating combinations of priors that are impossible for a given catch history and a specified functional form. -->

<!-- The full list of estimable parameters are listed in Table.\@ref(tab:param-tab).  -->

<!-- *r* and *K* are the only two parameters that are always estimated. Estimation of every other parameter can be turned on or off. When estimation is turned off estimable parameters are fixed at their initial values, which can either be set to model defaults or specified by the user. -->

<!-- sraplus can be run in two forms: either as a stock reduction analysis [SRA, @walters2006], or fit to an index of abundance (fishery dependent or independent). Unless there is an abundance index to fit to the model runs as a stock reduction analysis. A stock reduction analysis works by specifying prior distributions on population parameters and critically the recent state of the fishery. sraplus allows users to specify the most recent status in units of depletion, B/B~MSY~, F, or F/F~MSY~. We then sample from the prior distributions of the population model parameters and apply those to the production model, along with the catch history. Any run that results in the collapse of the population (catch greater than biomass in any time step) is immediately rejected. The remaining viable draws from the prior distributions are sampled in proportion to the supplied prior on recent stock status. Any model results based on data sources listed in Table.\@ref(tab:dat-desc) that do not contain "cpue" or "RAM data" are estimated through stock reduction analysis. All SRA style runs in our paper sampled 2,000 draws of the prior-predictive distribution from a total of 1e6 candidate draws. -->

When an index of abundance is available the model estimates the posterior probability distributions of the estimated and transformed parameters using Hamiltonian Monte Carlo implemented in Stan [@standevelopmentteam2018] accessed through the `tmbstan` interface [@monnahan2018]. By default the model uses 2000 draws with a 1000 step warm-up and one chain. Any detailed fit for an individual fishery would likely use more draws and chains, but we verified that this sampling routine produced an acceptable tradeoff of speed and convergence criteria. The model fits to a direct estimate of abundance (e.g. a fishery independent survey or a standardized catch-per-unit-effort index), the likelihood is

$$log(a_t) \sim normal(F(r,K,m,B0,\pmb{p},\pmb{c}) \times q, \sigma_{obs})$$

where *a_t* is the observed abundance index and *F* is the Pella-Tomlinson production model (Equation.\@ref(eq:pt)). When an effort index is available, sraplus constructs an index of abundance based on the catch and effort data. [@rousseau2019] measure an index of abundance as catch divided by their effort index, either nominal or effective (assuming the 2.6% annualized technology creep). Treating this raw effort data as the denominator in the CPUE calculation assumes that every increase in fishing effort translates to a commensurate increase in fishing mortality. When effort increases dramatically above historic levels, this can create a CPUE index that decreases faster than the true population. This is due to the fact that the marginal fishing mortality produced by increasing units of effort decreases as effort approaches infinity (since the fishing mortality rate is bounded between 0% and 100%). To accommodate this, we generate a catch per effective harvest rate index of abundance, as

$$cpue_t = \frac{c_t}{(1 - e^{-f_t})}$$

$$f_t = q_tE_t$$

Where $q_t$ can has a technology creep component $\tau$

$$q_t = q_{t-1} \times (1  + \tau)$$

We then fit to the index of abundance per

$$log(cpue_t) \sim normal(f(r,K,m,B0,\pmb{p},\pmb{c}), \sigma_{obs})$$

### CMSY {.unnumbered}

In addition to the results from sraplus, we include a set of results produced by the default settings of the CMSY method [@froese2017]. For computational efficiency, we used a ported version of the CMSY model available at <https://github.com/DanOvando/portedcmsy>. The only modification made is to convert the underlying population model to C++ for faster computation. For each stock we used all the default options and priors provided and generated by CMSY, in the same manner as @palomares2020, except for resilience, which was pulled from the vulnerability scores from FishBase accessed through `rfishbase` [@boettiger2012]. Vulnerability scores greater than 66 were scored as low resilience, between 33 and 66 medium resilience, and lower than 33 high resilience.

<!-- In the absence of an index of abundance CMSY and sraplus are conceptually the same: Both sample from prior distributions of life history and stock status conditional on the stock not collapsing given a catch history and a functional form for the population growth equation. The core different between CMSY and sraplus as utilized here then is that when we refer to CMSY we mean CMSY run using the default heuristics used by the algorithm to construct priors on initial, intermediate, and terminal stock status. In contrast, sraplus fit using for example FMI data uses the empirical models described here to generate priors on stock status. In addition, all sraplus runs use a prior-predictive tuning procedure to resolve issues related to Borel's paradox, described below. -->

## Priors {.unnumbered}

<!-- We address two critical features of prior use in sraplus below: tuning of the prior-predictive distribution and translation of outside data into priors usable by sraplus. -->

### Prior Predictive Tuning {.unnumbered}

<!-- We can think of this as a binomial process in which we fit a model of the population, conditional on catches, to the fact that we know that population existed in each time step of the catch history. Beyond that though, baring additional information or model assumptions we have no way of knowing whether these catches represent a substantial proportion of a small population or a minuscule fraction of a massive population; all we know is that the population must always have been above zero. -->

<!-- Suppose that the only thing we observe from a fishery is a catch history. Assuming only Pella-Tomlinson population dynamics, the only thing we can learn from this catch history alone is the set of model parameters that ensure that the population still exists and never collapsed in the past.  -->

In the absence of any data to fit to, the stock reduction algorithm (SRA) works by assuming that we know current stock status, and then finds feasible parameters to satisfy that belief given a catch history and model structure. This creates a problem for the Bayesian nature of our analysis. Consider a production model with two parameters, a growth rate *r* and a carrying capacity *K*. Once we specify prior distributions on *r* and *K*, and then apply these distributions to our model (the shape of the production function along with the catch histories), we have implicitly provided a prior on the status of the stock in all time periods, since each unique combination of *r* and *K* together with the model and the catch history produces a deterministic stock status in each time step. Doing so places two priors on recent stock status: one implicit prior through the population parameter priors, and one explicit through the users perception of recent stock status, creating a problem termed Borel's Paradox (See @poole2000 and references therein for a discussion of Borel's Paradox in a fisheries context).

This may seem like an academic concern, and indeed in our experience when the data are sufficiently informative the Bayesian version of our model subject to Borel's paradox produces effectively identical results to those produce by the same model fit by maximum likelihood. Borel's Paradox poses a particular problem  for the SRA version of sraplus. Due to the fact that there are more ways for a fishery to be relatively unexploited than for a fishery to be close to collapse, in this context Borel's Paradox causes the posterior distribution of stock status to be positively biased relative to the supplied prior (although combined with other modeling choices can result in a net negative bias in stock status, @free2020). This process can also make it easy for users to accidentally supply very informative priors on stock status, without realizing that choices relating to population biology priors that may appear independent of stock status are in fact dictating the posterior distributions of stock status resulting from the SRA algorithm.

We use an approximate solution to this problem here, similar in spirit to Bayesian melding [@poole2000]. Our solution amounts to a two-step sample-importance-resampling (SIR) algorithm. We first run the standard SIR algorithm as described above. We then break the resulting draws into bins based on terminal stock status, and calculate the mean sampling probability of each bin. The net result of this is that it allows users to place explicit prior on stock status, and then adjust their priors on life history parameters to reflect this prior, rather than creating a complicated and biased prior on stock status based on a mixture of explicit and implicit priors. See Supplementary Information for a detailed explanation of this problem and our solution.

### Priors Informed by Outside Data {.unnumbered}

Along with allowing users to supply their own priors, the sraplus package contains three built-in methods for converting information on stock status from additional outside data into a form usable as a stock status prior by sraplus. We paired data on catch histories, swept area ratio (SAR), and fisheries management index (FMI) with estimates of stock status from the RAM legacy stock assessment database. We then trained a regression of the general form $log(status) \sim normal(variable,\sigma)$ for each of these three data types. Given values of these variables for a new fishery, sraplus uses the fitted model to generate posterior predictive distributions of stock status based on these data, which can then be used as priors on stock status by sraplus for new fisheries. For example, given data on SAR or FMI scores, together with a catch history, sraplus uses these regressions to convert those SAR and FMI values into priors on *B/B~MSY~* or *F/F~MSY~* in the most recent year of the fishery usable by sraplus (See Supplementary Information). All prior regression models were tested by out-of-sample predictive power, and where competing models were considered the final model was chosen by leave-on-out validation [@vehtari2017]. The final models are intended as a reasonably robust means of translating available data (catch histories, FMI, and SAR values) into a form usable by sraplus.

<!-- Given the scope of this analysis, we do not claim that the regressions used here are the best possible model relating these data with the fishery status indicators of interest. Rather, each regression was tested to ensure that it is unlikely that, given the same data, an alternative model would perform substantially better than those presented here. -->


## Assessing Performance {.unnumbered}

Simulation testing can be preferable in many ways to comparison against model outputs. However it is not possible to simulation test the value of information derived from empirical relationships between variables such as fisheries management strength and fishery outcomes, which our study depends on. As such we assess model performance through comparison to best available estimates of stock status available in RAM.  We based this test on `r ram_comp_data$stockid %>% n_distinct()` stocks from RAM, covering `r n_distinct(ram_comp_data$isscaap_group)` broad taxonomic groups, with estimates of *B/B~MSY~* and greater than 25 years of continuous catch history. *B/B~MSY~* values from RAM are themselves estimates, not data, but they are the best available information on global stock status. We then paired the catch histories for these RAM stocks with regional-level SAR, FMI, and effort data.  Our methods approximated a regional-level assessment exercise, where data beyond catch histories are available at regional levels, but not for specific fisheries. 

We assessed the ability of FMI, SAR, and effort data to improve estimates of global stock status. We based this test on `r ram_comp_data$stockid %>% n_distinct()` stocks from RAM, covering `r n_distinct(ram_comp_data$isscaap_group)` broad taxonomic groups, with estimates of B/B~MSY~ and greater than 25 years of continuous catch history. B/B~MSY~ values from RAM are themselves estimates, not data, but they are the best available information on global stock status. We then paired the catch histories for these RAM stocks with regional-level SAR, FMI, and effort data. This process approximates a global-level assessment exercise, where data are available at regional levels, but not for specific fisheries. We also estimated *B/B~MSY~* values of our candidate RAM stocks by using sraplus to fit to an abundance index drawn directly from RAM itself "RAM Index", as a measure of the ability of models like sraplus if given perfect information

We then fit a range of models utilizing different combinations FMI, SAR, and effort data, along with CMSY, and a set based on the RAM Index (Table.\@ref(tab:dat-desc)). We assessed model performance using three metrics: median percent error (MPE, a measure of bias), median absolute percent error (MAPE, a measure of accuracy), and classification accuracy. Classification accuracy was calculated as the proportion of times that use of a given combination of data resulted in a stock being classified into the correct FAO status classification (one of underfished, maximally sustainably fished, and overfished). This experiment structure allows us to assess the ability of catch-only models to estimate the *B/B~MSY~* values reported in RAM, and evaluate how much these estimates can be improved by augmenting the catch histories with additional sources of information. Our benchmark model if a simple "Guess". Guess assigns each stock a random *B/B~MSY~* of 1.6, 1, or 0.4, corresponding to the middle value of the FAO status bins of underfished  ($ B/B~MSY~ \geq 1.2$), maximally sustainably fished ($0.8 \geq B/B~MSY~ < 1.2$), overfished  ($0 \geq B/B~MSY~ < 0.8$). 

```{r dat-desc}
dat_description <- tribble(~`Data Name`, ~Description,
        "RAM Index", "Fit to abundance index from RAM",
        "SAR", "Prior on terminal F/Fmsy set by regional swept area ratio",
        "FMI", "Prior on terminal F/Fmsy set by regional fisheries management index scores",
        "Efective CPUE", "Fit to CPUE index created from RAM catch and regional effort index. 2.6% technology creep",
        "Effective CPUE+", "Fit to CPUE index created from RAM catch and regional effort index with priors informed by SAR and FMI. 2.6% tech. creep",
        "Nominal CPUE", "Fit to CPUE index created from RAM catch and regional effort index. 0% tech. creep",
         "Nominal CPUE+", "Fit to CPUE index created from RAM catch and regional effort index with priors informed by SAR and FMI. 0% tech. creep",
        "Guess", "Priors on terminal B/Bmsy randomly sampled from .4,1,1.6")

knitr::kable(dat_description,
             caption = "Data sources used for terminal stock status estimate",
             format = "pipe") %>%
  kableExtra::kable_styling(full_width = T, font_size = 9) %>%
  kableExtra::row_spec(0, bold = T)
```


## Value of Information Calculations {.unnumbered}

We performed a value-of-information assessment to determine what types of data may be most beneficial to acquire at a global scale if we are to improve our knowledge of the state of global fisheries. The value-of-information analysis was performed by using sraplus to generate estimates of *B/B~MSY~* for stocks in RAM, and comparing the estimated values to the values reported in RAM. There are too many combinations for us to run the full expansion of possible parameter states. To resolve this we generated fits for 3000 combinations of a RAM stock and available data. For any one draw, we randomly sampled a RAM stock and a list of available data and data quality. For example, we might sample stock *A* with information on recent fishing mortality rates for the first iteration, and stock *A* again for the second iteration but now with information on recent fishing mortality rates and a recent index of abundance. The result is a set of model performance estimates where the characteristics of the stock and the data made available to the model are randomized. We then measured the value of information as the average reduction in root mean squared error (RMSE) in B/B~MSY~, resulting from use of different kinds of data. 

## Case Study {.unnumbered}

We also ran a case study demonstrating how different kinds of data led to different conclusions about stock status. We selected `r n_distinct(exs$stockid)` stocks for which we have stock specific FMI and SAR scores. We then paired effort data at the resolution of year, country, and FAO statistical area from @rousseau2019 to each stock. As a benchmark, we first estimated stock status for these case study fisheries using the default settings of the CMSY [@froese2017] method, as this has become one of the most widely used catch-only models currently available. We then used stock-specific data on SAR and FMI to generate priors on F/F~MSY~ for each of the stocks, which were then passed to sraplus. Lastly, we used the reconstructed effort data [@rousseau2019] to create an index of abundance for each stock, and estimated stock status by fitting to this index while using priors on fishing mortality rates informed by each stock's FMI and SAR values. This case study represents a more "localized" assessment, where external data sources (FMI and SAR) are available at the stock level, rather than at the regional level. 


<!-- To determine what sources of data might provide the greatest value in improving our estimates of global stock status, we fit 3,000 sraplus models to randomly sampled fisheries from RAM, each time varying the kind and quality of data made available to the model, and what parameters the model estimated. We then calculated the root-mean-squared-error (RMSE) between the observed and predicted B/B~MSY~ over the most recent five years of each fit, and then fit a regression to these data to estimate the posterior probability of the effect of different data types and model states on RMSE (Fig.\@ref(fig:voi-plot)). -->

# Results {.unnumbered}

## Case Study {.unnumbered}


Nearly all of the fisheries used in this case study have F/F~MSY~ values less than one, and most have B/B~MSY~ values greater than one. CMSY, using no stock-specific information but the catch history (which defines the prior on K and stock depletion, and hence the estimate of B/B\~msy\~) and the estimated resilience of the target species (based on Fishlife ([@thorson2020])), badly misses this trend, stating instead that nearly all the fisheries in this group are currently overfished and experiencing overfishing ($R^2$ for B/Bmsy = 0.1, $R^2$ for F/F~MSY~ = 0). Adding priors informed by stock-specific the swept-area-ratio and fisheries management index data produces some improvements, capturing the general state that most of these fisheries have low fishing mortality rates and biomass near or above B~MSY~. Fitting to an index of abundance created by regional effort data in fact produces a slightly poorer fit. This is largely because a number of stocks in this case study set have very low catches (relative to historic highs) and high biomass values. However none of the models fit to the three case-study data combinations were able to explain much of the variation in B/B~MSY~, though the models performed better in some cases for predicting F/F~MSY~ (though this is to be expected as the prior-generating models were trained on data from RAM). Models informed by the SAR and FMI values performed the best in terms of B/B~MSY~ ($R^2$ = 0.1). The ranking of performance by data sources used was the same for F/F~MSY~, though the range of values was much higher, with the SAR and FMI based result producing an $R^2$ of 0.47 while the default CMSY settings produced an $R^2$ of effectively 0 (Fig.\@ref(fig:cs-plot)). 

<!-- This is not in and of itself a surprising result, but demonstrates how 1) estimates of stock status based on catch histories alone can be both imprecise and biased and how 2) augmenting catch histories with additional data from the fisheries in question can produce meaningful improvements.  -->

<!-- `FishLife` [@thorson2017c] provides informative priors for key life history parameters (such as growth rates) needed by our model. We use the FMI and SAR values to construct Bayesian priors on initial and terminal stock status values (e.g B/B~MSY~ or F/F~MSY~, the fishing mortality *F* relative to the fishing mortality rate that would produce *MSY* at equilibrium), allowing us to translate local values of for example SAR into a prior on terminal B/B~MSY~. Where available, we use effort data to create stock-specific timeseries of catch-per-unit-effort (CPUE), which can be used as an index of stock abundance.  -->





```{r cs-plot, fig.cap="RAM values of *B/B~MSY~* and *F/F~MSY~* (x-axes) for case study fisheries plotted against estimated values (y-axes) using CMSY [@froese2017], priors informed by stock-specific Fisheries Management Index (FMI) and swept area ratio (SAR) scores, and an abundance index based on reconstructed effort trends assuming a rate of technological increase of 2.6%. Each point is a stock. Black dashed line shows the 1:1 relationship."}
ex_scatter_plot
```

<!-- That use of Swept Area Ratio and Fisheries Management Index data produced a more accurate estimate of stock status than catch alone should come as no surprise. In the absence of other data, the heuristics internal to CMSY linking catch to stock status, and the regressions linking SAR and FMI values to stock status, are themselves the assessment process. Since the SAR and FMI regressions were trained on the RAM stocks in question, this process simply confirms that for these stocks SAR and FMI data contain a reasonable amount of information on fishing pressure and by extension stock status. -->

## Performance of Regional Fishery Assessments {.unnumbered}

We first considered the performance of sraplus when the model was given a perfect index of abundance from RAM (RAM Index) for each stock in RAM it was tasked with assessing. Assessment models in RAM are typically much more structurally complex than the simple biomass dynamics used in sraplus, and so this "perfect information" test tells us how much of a penalty in model performance we are likely to pay due to model misspecification alone. The sraplus estimates of *B/B~MSY~* resulting from fitting directly to the abundance indices from RAM were relatively accurate and unbiased at a macro level (MPE `r percent(perf$mpe[perf$"Data Used" == "RAM Index"])`,MAPE `r percent(perf$mape[perf$"Data Used" == "RAM Index"])`, accuracy = `r percent(perf$accuracy[perf$"Data Used" == "RAM Index"])`, Table.\@ref(tab:perf-tab), Fig.\@ref(fig:mpe-map)-\@ref(fig:acc-map)). This exercise tells us that given sufficiently high quality data, a surplus production model such as sraplus is reasonably capable of reproducing the global state of fisheries as understood from formally assessed fisheries.

<!-- Performance limitations in assessments of global fishery status then are likely to arise less from model misspecification than from the quality of the data themselves.  -->

 <!-- However, this is somewhat an artifact of the data. The status of most stocks in RAM is relatively good, with recent *B/B~MSY~* values generally near one. This means that a model that more or less reproduces the global average of stock status will be relatively unbiased on average, but imprecise. -->

We next assessed the ability of FMI, SAR, and effort data to improve estimates of global stock status beyond those derived from catch-only methods. Many of the datasets used produced similar levels of bias as the RAM data (e.g. FMI, SAR, Nominal CPUE fits), though notable the "Guess" method actually performed near the top in terms of bias. However, this is somewhat an artifact of the data. The status of most stocks in RAM is relatively good, with recent *B/B~MSY~* values generally near one. As the mean value of the "Guess" method is one, on average the "Guess" model is an unbiased but imprecise measure of stock status in RAM (Table.\@ref(tab:perf-tab)). 

Focusing on MAPE (our measure of error rather than bias) and classification accuracy, the error of the models jumps dramatically as soon as data other than the RAM abundance indices are used, to a minimum value of `r percent(perf$mape[2])` and a maximum of `r percent(max(perf$mape))`. The mean accuracy of the sraplus models across all non-RAM data fits was `r percent(mean(perf$accuracy[!perf$"Data Used" %in% c("RAM Index","Guess")]))`. Note that there are only three bins in the FAO stock status classifications, and a so our "Guess" model has a mean accuracy of `r percent(perf$accuracy[perf$"Data Used" == "Guess"])`. This means that the accuracy of our models designed as a proxy for a global assessment process were across all non-RAM index data fits `r percent(mean(perf$accuracy[!perf$"Data Used" %in% c("RAM Index","Guess")]) / perf$accuracy[perf$"Data Used" == "Guess"] - 1)` more accurate than a random guess, certainly an improvement, but on average assigned fisheries to the wrong FAO status bin `r percent(1 - mean(perf$accuracy[!perf$"Data Used" %in% c("RAM Index","Guess")]))`of the time. 

Looking geographically we found a similar pattern of a rapid decrease in performance for models besides those fit to the RAM Index. Across the models, performance was not consistent in space: use of different data performed best or worst for different FAO regions. Models fit to nominal CPUE data substantially overestimate stock status in the Mediterranean, while models based on data using effective CPUE perform better in that region (but worse in others) Fig.\@ref(fig:mape-map). We find similarly inconsistent performance for both bias (Fig.\@ref(fig:mpe-map)) and accuracy (Fig.\@ref(fig:acc-map)). Overall, while some data sources performed slightly better than others by some metrics in some places, no models using any non-RAM data were able to capture the overall state or geographic distribution of stock status represented in RAM in a consistent manner. 

```{r perf-tab}

knitr::kable(perf, digits = 2,
             caption = "Global performance statistics in the most recent year available of models using different sources of data. mpe = median percent error (bias), mape = median absolute percent error (error), accuracy = percent of times that stocks were classified to the correct FAO status bin (underfished, maximally sustainably fished, overfished). Performance is judged relative to reported values in RAM Legacy Stock Assessment Database.",
              format = "pipe")

```

<!-- xx dig into this, which stocks are in that region? XX -->

```{r mpe-map, fig.width=8, fig.height=6, fig.cap="Median percent error (MPE, predicted relative to observed) in most recent *B/B~MSY~* by FAO statistical area from different data sources. RAM Index refers to catch and abundance index drawn from RAM. Effective CPUE refers to an index of abundance based on reconstructed effort data. Effective CPUE+ uses CPUE along with Fisheries Management Index (FMI) and/or swept area ratio (SAR) data. For both CPUE series 'nominal' assumes a 0% technology creep, for effective a 2.6% technology creep is assumed. FMI uses FMI scores to develop a prior on recent fishing mortality rates, SAR does the same but based on swept area ratio. CMSY uses the methods from Froese et al. 2017 [@froese2017]. Guess assignes a random recent *B/B~MSY~* of 0.4,1, or 1.6. Panels ordered in asscending (starting from top left) mean MPE at the FAO region level. "}
ram_mpe_map_plot
```

```{r mape-map, fig.cap = "Median absolute percent error (MAPE) in most recent *B/B~MSY~* by FAO statistical area from different data sources. RAM Index refers to catch and abundance index drawn from RAM. Effective CPUE refers to an index of abundance based on reconstructed effort data. Effective CPUE+ uses CPUE along with Fisheries Management Index (FMI) and/or swept area ratio (SAR) data. For both CPUE series 'nominal' assumes a 0% technology creep, for effective a 2.6% technology creep is assumed. FMI uses FMI scores to develop a prior on recent fishing mortality rates, SAR does the same but based on swept area ratio. CMSY uses the methods from Froese et al. 2017 [@froese2017]. Guess assignes a random recent *B/B~MSY~* of 0.4,1, or 1.6. Panels ordered in descending (starting from top left) mean MAPE at the FAO region level",fig.width=8, fig.height=6}
ram_mape_map_plot
```

```{r acc-map, fig.cap="Mean classification accuracy (assignment to FAO stock status category) by FAO statistical area arising from different data sources. RAM Index refers to catch and abundance index drawn from RAM. Effective CPUE refers to an index of abundance based on reconstructed effort data. Effective CPUE+ uses CPUE along with Fisheries Management Index (FMI) and/or swept area ratio (SAR) data. For both CPUE series 'nominal' assumes a 0% technology creep, for effective a 2.6% technology creep is assumed. FMI uses FMI scores to develop a prior on recent fishing mortality rates, SAR does the same but based on swept area ratio. CMSY uses the methods from Froese et al. 2017 [@froese2017]. Guess assignes a random recent *B/B~MSY~* of 0.4,1, or 1.6. Panels ordered in descending (starting from top left) mean accuracy at the FAO region level",fig.width=8, fig.height=6}

ram_acc_map_plot 
```

\newpage

<!-- The poor global performance of models fit to currently accessible broadly available datasets, relative to models fit to data from RAM, indicates that we must prioritize collection and aggregation of new or underutilized data sources if we are to improve our estimates of global fishery status.  -->

## Value of Information {.unnumbered}

What sources of data might provide the greatest value in improving our estimates of global stock status? Having access to estimates of *F/F~MSY~* reduced model error in proportion to the number of years for which *F/F~MSY~* values are available. Interestingly though, having access to only an accurate estimate of F/F~MSY~ in the most recent year was extremely informative, reducing error on average by 15%, on par with an estimate of recent *B/B~MSY~* itself  (Fig.\@ref(fig:voi-plot)). While having access to complete index of abundance, such as a fishery independent survey, was on average able to reduce error relative to a baseline catch-only heuristic, using only the most recent quarter of the available abundance index actually increased error on average, due to the lack of historical context for recent trends in abundance. 

<!-- We may have to wait many years for new surveys to provide substantial improvements in status estimates, or work to expand access to long-running existing surveys that have yet to be fully utilized in fisheries assessment [@maureaud2020]. -->

```{r voi-plot, fig.cap="Posterior probability distributions of estimated effect of different data types on root mean squared error of *B/B~MSY~* in the most recent 5 years of data available for each model fit. Distribution is full posterior probability distribution. Point is median, thicker black section inner 66th quantile of the posterior, the thinner black line the 95th. Change is relative to the mean performance of a catch-only heuristic model."}
b_voi_plot + 
  geom_vline(aes(xintercept = 0), alpha = 0.75)
```

#  Discussion {.unnumbered}

<!-- XX somewhere in here make clear that you're not learning anything from the catch data XX -->

<!-- XX Acknolwedge the need for action the the frustration of being told "get more data" XX -->

<!-- Global-level assessment are critical for guiding management agendas for the world's oceans. Despite this need, and despite advances in stock assessment methods, our understanding of the world's fisheries remains murky in many parts of the world. Numerous efforts have sought to resolve this problem through development of new modeling methods. These studies have ranged from simple heuristic algorithms to superensemble modeling, but while these studies have advanced our knowledge and motivated important conversations about the state of unassessed fisheries, each has demonstrable shortcomings as an answer for global fisheries assessment. However, a growing number of broadly (if not globally) distributed datasets have become available recently, leading us to ask whether using these data to move beyond "catch-only" models for global assessment would produce more reliable outcomes. While we demonstrate that these data can provide value above and beyond the catch histories alone, addition of these data alone does not substantially clarify the picture of global fisheries status.   -->

<!-- Our results show that estimates of stock status based on catch histories alone stem almost entirely from underlying assumptions, not the information content of the catches, producing results that are inconsistent with best-available knowledge of the state of assessed fish populations in RAM -->

Global-level assessments of fish populations are critical for guiding management agendas for the world's oceans, and tracking indicators such as the United Nations Sustainable Development Goals. The hope of efforts using catch-only models to estimate the status of global unassessed fisheries is fundamentally that we can learn something meaningful about the state of a fished population simply by knowing something about its catch history and life history. While in some cases the addition of globally available data such a FMI scores, SAR values, or effort reconstructions, provided value above and beyond catch histories alone (Fig.\@ref(fig:cs-plot)), at the global level models fit using each of the available datasets, besides the RAM-derived indices, generally produced biased and imprecise estimates of fish stock status (Table.\@ref(tab:perf-tab)).


What quality of assessment is needed and what constitutes a meaningful improvement in assessment quality depends on the needs of those using the assessment outputs. It may be that for particular regions, species, or uses the results presented here or in other past global analyses are sufficient. In some instances using the data presented here did provide some improvement over use of catch-only style assessment methods; the difficulty comes in attempting to apply data types uniformly across the globe. While it is unreasonable to expect models based solely on global-scale data to be able to perform as well as detailed stock assessments reported in RAM, or that data-limited methods would perform well for every individual stock, our hope would be that a data-limited approach based on globally available data sources would be able to correctly capture general patterns in stock status in time and space. The overall poor performance of the models tested here shows that improvements in estimates of global stock status depend on improvements in the quality and use of data themselves

<!-- That use of none of the datasets collected here can achieve that, and that our tests fitting directly to abundance indices from RAM itself suggests that model misspecification is not the primary cause of poor performance, tells us that improvements in estimates of global stock status will likely depend on improvements in the quality and use of data themselves.  -->

Our claim is that achieving substantial progress in assessing the state of global fisheries will require improved data and capacity building. This claim cannot be definitively proven; It is possible that some yet-to-be discovered model will provide a reliable means of dramatically improving the accuracy of estimates produced by models using current broadly-available datasets, such as catch-only style methods. Should that occur we will be happy to have been proven wrong. However, efforts from numerous groups made up of highly skilled scientists tasked with solving this problem have all come up short, particularly when external efforts tried validate their performance [@free2020;@bouch2021;@pons2020]. This is not intended as an indictment of those past efforts, but a reflection on the limited amount of broadly applicable predictive power that exists within catch histories alone. Methods tested in those papers have been demonstrated to perform relatively well when given data or priors informative to specific fisheries. We revisited this task in this paper, and found that even when augmented with other broadly available datasets, we were unable to produce consistently accurate estimates of stock status around the globe. For these reasons we believe that improvements to our understanding of the state of global unassessed fisheries will come from targeted use of existing data, and expanding the collection of high-priority data around the globe, rather than the development of new modeling methods alone. 

We chose to test the performance of methods against estimated values reported in RAM. A reasonable critique of this choice is that unassessed stocks, on which these methods would actually be used, are likely to have vastly different dynamics than the heavily managed fish populations represented in RAM, in addition to the errors in the RAM estimates themselves. For this reality to change our results though would require that the methods tested here have massively lower bias and higher accuracy for unassessed fisheries than RAM stocks. @free2020's simulation based based results of these same types of models suggests that this is unlikely to be true.

<!-- Our estimates of global stock status vary wildly depending on which source of data we use. Why not simply pick the best source of data, or use all the available data, and use that to update our estimate of global stock status, under the grounds that that is the best available information? Unfortunately, it is not clear that we can evaluate which source of data provides the best fit; examination of each shows strengths and weakness that are not easily comparable (Fig.\@ref(fig:mape-map)). Globally available effort data from @rousseau2019 allows us to create local indices of abundance based on catch histories but carries a host of critical assumptions, namely that the same effort history applies to all fisheries in the region, or country if country level effort data are used. These CPUE indices are also extremely sensitive to assumptions around rates of change in catchability. The fisheries management index has some ability in predicting stock status (Fig.XX), but out-of-sample testing reveals limitations. Swept-area ratios have a strong relationship with fishing mortality rates, but only for comparable fisheries; it is unclear how good a proxy this measure is for non-demersal stocks. None of these data, or combinations thereof, was able to satisfactorily match the FAO's SOFIA assessments, or the assessments presented in RAM (XX RAM matches? need to add an analysis: match stocks from SOFIA to RAM stocks where possible, plot comparison).  -->

Our results do not imply that the kinds of broadly available data presented here are not valuable under the right conditions. The FMI and SAR based priors are an improvement over catch-only models in applicable situations (i.e. those that sufficiently resemble the data on which the regressions were trained, Fig.\@ref(fig:cs-plot)). Effort data such as those reconstructed by @rousseau2019 can help distinguish between regions with similar catch histories but different large-scale effort trajectories, and may be quite useful as indices of abundance for areas with good knowledge of rates of evolution of fishing technology and a broadly selective fishing fleet. Despite not adding a great deal in terms of performance at the global scale, swept-area-ratio was the strongest predictor of F/F~MSY~ of any of the datasets we explore on an individual stock basis, with a Bayesian R^2^ value of `r round(mean(rstanarm::bayes_R2(sraplus::sar_models$fit[[3]])),2)`.But, we must simultaneously consider data quality and resolution: applying one SAR value to all stocks in a region, even if that SAR value can provide valuable information for a subset of fisheries, causes inaccurate estimates of stock status when applied too broadly. Our analysis does not show that the data considered here are without value, but that attempting to indiscriminately apply these data to all areas of the globe results in meaningfully incorrect estimates of stock status for regions whose nature does not match the assumptions needed to apply these data sources.

Our value-of-information analysis also shows the high utility of having access to even a recent snapshot of F/F~MSY~ (Fig.\@ref(fig:voi-plot)). Swept area ratios, Fisheries Management Index scores, or other similar metrics can be used to construct fishery-specific priors on fishing mortality rates, though care must be taken in applying them at the appropriate spatial resolution. Another avenue would be to prioritize the development of a global repository for length and age composition data. Given appropriate conditions, these length measurements can be used to estimate local fishing mortality rates [@hordyk2016; @prince2019; @rudd2017]. While length-based assessments come with a host of assumptions and pitfalls, properly implemented in some fisheries with appropriate life histories these methods may provide an overlooked source of information on fisheries at a global scale, at least as an improvement over relying on catch-only or regional proxies alone. Such a database could be used to construct stock or stock complex specific priors on fishing mortality for particular regions around the globe, which could meaningfully improve our understanding of global fisheries, particularly when paired with catch data and where possible indices of abundance [@thorson2015f; @rudd2017].

<!-- Using catch data alone does not reveal about recent stock status beyond what is encoded in our priors and functional forms. So if we had good estimates of B/B~MSY~ our job would already be done without any need to run something like `sraplus` (except to derive other quantities of interest). Given the demonstrated value of F/F~MSY~ values in improving estimates of stock status, and the increased feasibility in estimating F/F~MSY~ at a local scale relative to B/B~MSY~, how might we go about obtaining estimates of fishing mortality rates at a global scale? We have demonstrated one potential approach here; fisheries management index and swept area ratio values both provide reasonable predictions of F/F~MSY~ for individual fisheries (see Supplemental Information). While assigning mean FMI and SAR values at the taxonomic and regional level as we did in Fig.\@ref(fig:mpe-map)-\@ref(fig:acc-map) did not perform particularly well, efforts to assign FMI and SAR values to individual stocks or appropriate stock complexes might be more fruitful. -->

We must also prioritize collection and curation of fish population survey data worldwide. Repositories of fishery-independent survey data would be immensely beneficial, such as those maintained by [FishStat](https://www.FishStats.org)( www.FishStats.org). Recent research confirms that there are bottom trawl data to support analysis of biomass-trends since 2001 and potentially earlier in many regions [@maureaud2020], and survey data are available for more stocks than have stock assessments. Effort reconstructions such as those utilized here may help create fishery-dependent abundance indices in some instances, and going forward datasets such as those compiled by [Global Fishing Watch](https://globalfishingwatch.org/)((https://globalfishingwatch.org/) in combination with the reconstruction approaches of @rousseau2019 might allow us to construct and use timeseries of fishing effort specific to particular areas, fleets, and species complexes. However, out value of information exercise indicates that we may have to wait many years for new surveys to provide substantial improvements in status estimates (Fig.\@ref(fig:voi-plot)).


Expanded training of fisheries scientists around the globe is another critical need. Even were we to dramatically expand the amount and types of data available for global assessment, individual fisheries and regions will need to make informed decisions about which sources of data may be applicable and which not, and to critically evaluate the results of any model based on local expertise. This is why stock assessments even in data-rich fisheries are not an automated process; the real challenge is often not in fitting a model to data but in understanding how best to use the data and the quality and limitations of the model used. Empowering a global network of fisheries scientists through training and peer-support would help local experts make the most of available data, ensure the reliability of newly collected data, and improve the interpretation of assessment results.

The coming decades are a critical time for the future of fisheries and ocean health. Achieving the United Nations Sustainable Development Goal 14 for the conservation and sustainable use of the world's oceans depends on our ability to effectively assess the status of fish stocks around the world. The RAM Legacy Stock Assessment Database combined with the FAO's expert elicitation of status for select stocks have dramatically improved our understanding of global fisheries in recent years. However, this process still leaves a substantial number of fisheries and proportion of global catch unassessed. Numerous catch-based data-limited approaches have attempted to fill that gap, and while these efforts have advanced our knowledge and interest in unassessed fisheries, none have yet been able to provide a solution to this problem which has proven to be unbiased and sufficiently precise at a global or regional level.

<!-- Our results show that improving estimates of global stock status depends on investing in an improved and expanded global network of fishery data and fisheries scientists. -->

The lack of strong information on stock status within catch histories alone means that differences in models and assumptions between catch-based assessment efforts can produce starkly contrasting conclusions on global stock status, leading to debates that are inconclusive as they are inherently driven by assumptions. The FAO is leading efforts to increase technical capacity and monitoring and evaluation infrastructure to improve fisheries management in places with limited data. Such projects stand to provide a better picture of fishery status at global and local scales, furthering our ability to meet the UN SDG targets. Our results emphasize the urgency and rationale for building the infrastructure and capacity that can lead to better marine resource management globally [@costello2020]. Catch-only methods may be a useful starting point when applied properly, but the source of their information must be clearly communicated, and achieving meaningful improvements in the assessment and management of global unassessed fisheries will depend on expanded collection of targeted data types, active management, and local capacity building.

<!-- The need is to develop better datasets and approaches on the ground that can lead to more conclusive inferences about the state of global unassessed fisheries. -->



# Acknowledgements {.unnumbered}

Funding for this work was provided by the Food and Agriculture Organization of the United Nations (FAO). We thank participants of the FAO "Methods for Global Assessment" workshop held in Rome, Italy February 2019 for helpful feedback on this project. The scientific results and conclusions, as well as any views or opinions expressed herein, are those of the author(s) and do not necessarily reflect those of NOAA or the Department of Commerce.

# References {.unnumbered}

::: {#refs}
:::

# Supporting Information {.unnumbered}

```{r si, child = 'ovando-etal-assessing-global-fisheries-si.Rmd'}
```
