---
title: "The Future of Global Fishery Assessments"
author: 
  - Daniel Ovando
  - Ray Hilborn
  - Cole Monnahan
  - Merrill Rudd
  - Rishi Sharma
  - James Thorson
  - Yimin Ye
date: "`r Sys.Date()`"
bibliography: ["../references.bib"]
csl: nature.csl
output: 
  bookdown::word_document2:
    reference_docx: word-template.docx
  bookdown::pdf_document2: default
abstract: |
  Assessments of the global state of fisheries play an important role in shaping the public narrative around ocean health, motivating future directions of research and funding, and tracking large-scale objectives such as the United Nations Sustainable Development Goals. Numerous high-profile publications have produced estimates of the global status of fisheries, but limited quantity and quality of data, conflicting results, and methodological concerns mean that our understanding of global fisheries is still highly uncertain, especially in critical areas such as Southeast Asia and Africa. We present an evaluation of the past and future of global fishery assessments. Global assessments have typically involved aggregating best-available stock assessments where possible with various data-limited assessments for regions lacking formal evaluations of stock status. The data-limited methods used have ranged from simple catch heuristics to super-ensemble modeling. Despite attempts at model improvement, there have been discrepancies both among global fishery assessments and between the data-limited components of these methods and more data-rich models,demonstrating that our understanding of global data-limited fisheries remains limited. How then can we most efficiently move forward? We utilize a flexible assessment model together with the RAM Legacy Stock Assessment Database not strictly as a stock assessment tool, but to assess the value of different kinds, quantities, and quality of data in improving estimates of fishery stock status. We then explore avenues for obtaining potentially impactful data, including through the use of local expert opinion and increasingly available but historically underutilized data such as trawl footprints. These data are then used to illustrate how different types of information paint starkly different pictures of the state of fisheries around the world. We close by discussing priority areas for future data collection. Our results make the case that improving our understanding of global fisheries depends not on better models, but on better data.
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, dpi = 600,
                      cache = FALSE, fig.width = 6, fig.asp = .75, dev = "png")
library(tidyverse)
library(sf)
library(hrbrthemes)
library(extrafont)
library(scales)
library(here)
extrafont::loadfonts()

results_name <- "v0.5"

results_dir <- here("results",results_name)

load(file = file.path(results_dir, "paper_plots.Rdata"))

pub_theme <- theme_ipsum(base_size = 12, 
                         axis_text_size = 12) + 
    theme(panel.spacing = unit(1,"lines"))


theme_set(pub_theme)

```


Target journal: Nature Sustainability 

https://www.nature.com/natsustain/about/content

3500 words main text 
 
50 references (main text)

3000 words (max) methods

# Introduction (500 words)

The United Nations Sustainable Development Goal 14, related to "Life under water", calls for the global community to "Conserve and sustainably use the oceans, seas and marine resources for sustainable development". A substantial part of achieving this goal rests on ensuring that marine fisheries are managed to levels that ensure the conservation and sustainable use of ocean ecosystems. Achieving this goal depends in part on our ability to effectively track the status of global marine fish stocks. The Food and Agriculture Organization of the United Nations' (FAO) State of World Fisheries and Aquaculture (SOFIA) report is the standard source for tracking this important metric. As of the most recent report, the FAO estimates that as of 2017 59.6% of marine fish stocks are maximally sustainably fishery, 6.2% are underfished ,and 34.2% are overfished [@fao2020]. 

However, there is room for substantial improvement in the methods used in estimating global stock status. 49% of landings of marine fishes reported by the FAO are represented in the RAM Legacy Stock Assessment Database, a repository of "gold standard" estimates of fishery status [@hilborn2020]. The SOFIA process uses these formal assessments for their determinations of stock status wherever possible. However, that leaves 51% of global fisheries landings lacking in formal stock assessments. While these "unassessed" stocks are generally individually smaller than the typically larger and more valuable stocks in the assessed category, collectively they are a vital source of food, employment, cultural value, and ecosystem services around the world. 

The SOFIA report bases its estimates of included unassessed stocks mostly on expert elicitation. While local experts often are well informed as to the status of their fish stocks, a more quantitative and reproducible process would be desirable. Numerous studies in recent years have put forward versions of "data-limited" models that have attempted to provide estimates for the global status of these unassessed stocks [@costello2012;@costello2016a;@rosenberg2018;@pauly2007].Formal stock assessment require at a minimum robust timeseries of captures and a reliable index of abundance such as catch-per-unit-effort (CPUE). While most of the world's largest and most valuable fisheries have these data and have stock assessments based on the data [@hilborn2020], for many of the world's fisheries these data do not exist, and would be prohibitively expense to collect. Even when data are available though, running an individualized stock assessment is not a "just press play" process. Assessment scientists must make careful considerations about the quality and subsequent weighting of available data, the level of biological abstraction that the species and the data can support in the assessment model, and of course the quality of results produced by the assessment. This process takes considerable time and expertise. 

Data-limited methods applied to the question of global stock status typically make compromises on both the data requirements and individual attention needed for formal stock assessment. Given that catch statistics are, to date, the only globally available form of comparable fishery data, global data-limited assessments have typically been forms of "catch-only" models [@free2020 and references therein]. These models seek to infer stock status, for example in terms of biomass *b* relative to the biomass at maximum sustainable yield *b~MSY~*, from characteristics of a fishery's catch history, for example the ratio of catch to maximum catch [@martell2013]. In addition, given that a global assessment by its nature requires producing results for hundreds or thousands of individual fisheries within a reasonable amount of time. As such, rather than spending time carefully evaluating the quality of the data, model assumptions, and model fit for individual stocks, global data-limited methods typically aim for a method that is on average correct, but may not be reliable for assessment of individual stocks (high variance, low bias).Each of these methods sought to address specific gaps in our understanding of global fisheries, and in doing so introduced unique strengths and weaknesses. 


However, @free2020 demonstrated that these catch-only models can often produce both imprecise and biased estimates of B/B~MSY~. These issues become apparent when we consider some of the macro-level predictions made by these models. Examining stock assessment data from RAM from the NE Pacific, the NE Atlantic and the Mediterranean, the NE Pacific is in the best state (mean RAM b/b~MSY~ = 1.8), NE Atlantic (mean RAM b/b~MSY~ =1.3) and the Mediterranean the worst (mean RAM b/b~MSY~ =0.5).  We do not have formal stock assessment data from S. and SE Asia (Western Central Pacific and Eastern Indian Ocean), but based on surveys and expert opinion we believe it should be worse than Northeast Pacific. The Costello et al. 2016 [@costello2016a] model shows the correct general pattern in terms of relative ranking of regions, but we would expect the state of fisheries in the Mediterranean/Black sea regions and SE Asia to be much worse, and the NE Pacific better by comparison. The Rosenberg super-ensemble method [@rosenberg2018] demonstrates the same problem, with stocks in SE Asia estimated as doing better than the NE Atlantic or NE Pacific. The catch based approach @pauly2007, which compares catch in the last year to maximum catch, finds the stocks of Southeast Asia in much better condition than the Northeast Pacific or Northeast Atlantic (Table.\@ref(tab:status-tab)). 

```{r status-tab}

readr::read_csv(here("data","status-table.csv")) %>% 
  knitr::kable(caption = "Status by FAO Statistical area from four different assessment methods",
               booktabs = TRUE) %>% 
  kableExtra::kable_styling(full_width = T, font_size = 9) %>%
  kableExtra::row_spec(0, bold = T)
```


The coming decades are a critical period for the future of global oceans. Climate change, population growth, and economic expansion will all place increasing pressure on fisheries. While our understanding of global fisheries has improved greatly,  mitigating these threats, as called for by SDG 14, will require an improved ability to track the status of fisheries around the world, particularly those stocks that are currently unassessed. At the same time, new sets of globally distributed data have recently become available, along with advances in statistical modeling methods. We leverage these opportunities to provide a global assessment of our perception of global stock status resulting from different use of different data sources. Our results demonstrate that modeling improvements alone cannot provide a satisfactory answer to the question of global fishery status, requiring instead a robust and worldwide data collection and interpretation effort. 

# Results  (2000 words)

We use a new assessment package, [`sraplus`](www.github.com/danovando/sraplus) to demonstrate how different sources data can be used to augment catch-only models at a global scale, and to evaluate how our perception of global stock status would vary depending on which sources of data we include. The FAO's catch statistics remain the most widely accessible and used source of information on global fisheries. However, catches are not the only broadly available source of fishery data. We augment the FAO's catch statistics with broadly distributed data on fishing effort [@rousseau2019], strength of management [@anderson2015], trawl-fishing footprints [@amoroso2018], and life history [@thorson2017c]. `sraplus` provides a flexible framework for integrating these data into valid statistical model. `FishLife` [@thorson2017c] provides informative priors for key life history parameters (such as growth rates) needed by our model. We use the FMI and SAR values to construct Bayesian priors on initial and terminal stock status values (e.g B/B~MSY~ or F/F~MSY~, the fishing mortality *F* relative to the fishing mortality rate that would produce *MSY* at equilibrium), allowing us to translate local values of for example SAR into a prior on terminal B/B~MSY~. Where available, we use effort data to create stock-specific timeseries of catch-per-unit-effort (CPUE), which can be used as an index of stock abundance. 


## Case Studies 

Two case studies provide examples of how augmenting catch data alone with local and globally available data can provide dramatically different estimates of local stock status. For our first case study, we augment local catch statistics from the Eastern Bay of Bengal (XX details on these data) with catch-per-unit effort data from a local study, as well as a local estimate of swept-area-ratio for the region. We can then compare the estimates of stock status that come from using the catch-data alone (with a heuristic algorithm in the manner of @martel2013), with the catch data along with priors on terminal depletion informed by the swept-area-ratio data, and using the swept-area ratio data together with a local abundance index. By it's nature the catch-only heuristic produces a bi-model distribution, with most fisheries reported to have a B/B~MSY~ of 1.5 and an F/F~MSY~ less than 1 (Fig.\@ref(fig:east-india)-heuristic). Local experts put the swept-area-ratio (SAR) value for the region at an incredibly high 17. Using this value to inform a prior on terminal stock status dramatically changes our picture of stock status in the Eastern Bay of Bengal, with now all stocks being overfished and experiencing high levels of overfishing (Fig.\@ref(fig:east-india)-sar). 

<!-- Evaluating the validity of data-limited assessments methods can be challenging. Simulation testing provides one avenue, but it can be difficult to create a simulation environment that adequately captures the problems of real-world ecosystems and data. We can also compare results between data-limited assessment and more data (or resource) rich gold-standard stock assessments. However, formally stock assessed fisheries represent a very biased subset of global fisheries, and it is entirely possible that a method that performs well for the kinds of species and fisheries that are commonly stock assessed might struggle in the kinds of fisheries that typically are unassessed.  -->

<!-- Alternatively though, while we may lack formal assessment for many regions of the world, stakeholders familiar with a region often have a general sense of the state of fisheries in a region. As outlined in Table.\@ref(tab:status-tab), while we often have no proof that results finding that for example fisheries in south-east Asia have similar stock status to those in Alaska, very few experts would agree that this is a plausible result XX tough statement to make in a paper xx. We use two case studies here to present the potential of additional, broadly applicable, data to potentially improve on "catch-only" methods.  -->



If all the stocks in question were demersal, shared similar life histories, and were all caught in the same multi-species fleet, this result might make sense. However, imposing the same prior on terminal stock status for all fisheries in a region is not ideal. Supplementing these data with a local index of abundance provides a more nuanced figure, with most stocks estimated as having B/B~MSY~ less than 1, but with a much wider range of fishing mortality rates reflecting difference in recent catch histories among individual stocks (Fig.\@ref(fig:east-india)-"cpue + sar"). While we do not know the true state of stocks in the Eastern Bay of Bengal, inclusion of local data provide a picture more in line with local perception XX. 

```{r east-india, fig.cap="Estimates of stock status for fisheries in the Eastern Bay of Bengal using the catch heuristic, fishing mortality priors informed by swept area ratios, and a local index of abundance together with swept area ratio. Each point is a stock."}
ei_kobe_plot 
```


It should be no surprise that incorporating locally tailored data produces more locally plausible results. Global assessment at the moment though requires depending on a few broadly available datasets. To give an illustration, we used `sraplus` to assess the status of in Europe and Northeast Asia using catch data from the FAO augmented with regional effort indices constructed from @rousseau2019 (xx technically this is the updated dataset xx). Catch histories for Europe and Northeast Asia look somewhat similar xx plot of catch and effort histories xx. As a result, using a "catch-only" heuristic, both Europ and Northeast Asia are estimated to have very similar stock status, a similar finding as those illustrated in Table.XX. Adding in the effort data (as an effort index created for each stock as catch divided by the effective harvest rate based on the effort data), and the two regions begin to diverge. While according to @rousseau2019, Europe has seen a recent decrease in fishing effort from a peak in XX, effort in Northeast Asia has increased more or less continuosly. As a result, `sraplus` estimates that more stocks in Northeast Asia are overfished / experiencing overfishing than in Europe. However, the shared effort series across these stocks aslo produces a large number of effectively unfished stocks; a highly unlikely result for both regions. 

XX need to redo this analyis with the new effort data XX

```{r eu-v-na, fig.cap="Estimates of stock status in Europe and Northeast Asia using either a simple catch heuristic as presented in @martell2013 or an abundance index based on continental-scale effort trends reported in @rousseau2019. Each point is a stock, point size is a function of stock size."}
continent_kobe_plot
```

## Conflicting Estimates of Global Status


This exercise reveals the potential and challenges using broadly available data for global fishery assessment. On the one hand, for both case studies moving beyond catch data alone produced a more plausible set of results. However, both results also raise a host of new issues. How realistic is it to share one index of abundance and SAR value for the entire eastern Bay of Bengal? Similarly, the sharing of a common effort series at the continental level does provide increased separation between European and northeast Asian stocks that may be plausible, but also estimates a suspicious amount of stocks to be essentially unfished (a dynamic which does not match assessments from that region XX plot RAM stocks for europe XX). 

Extending these issues to the global level, we assessed the status of stocks assessed by the FAO's latest SOFIA report using various types of broadly available data. Given that the SOFIA assessments present the best estimates of stock status across both assessed and unassessed stocks, we would hope that any assessment method suitable would produce broadly match the values reported by the FAO. We focus here on the percent of stocks classified as "overfished" (B/B~MSY~ < 0.8) in each FAO statistical region. Following the SOFIA methodology, "Stocks" are classified by the sum catch histories across the same species within a major FAO statistical region. 

Our perception of global fishery depends completely on which data sources we utilize. That different data tell different stories should not be surprising. However, we also do not see a convergence towards a cohesive picture of global status that closely matches the SOFIA report as we add more data. The most data-poor method employed, the catch heuristic alone, matches some patterns from the SOFIA report (little overfishing in the Northeast Pacific, some overfishing in the northwest Atlantic), it misses the mark badly in other regions, e.g. the waters around New Zealand. Our most data-rich scenario, an effort series from @rousseau2019, along with priors from swept-area-reatio and fisheries management index where available....

to provide more plausible seeming results than catch data alone. A reasonable question then is, can we simply augment global catch statistics with the data presented here to provide an improved understanding of global fisheries? 


This is the main plot of the paper Percent of stocks classified as overfished depending on what data you use. CPUE data are at the continental scale (e.g. use North America Rousseau effort for USA, Mexico, Canada). 

key message: Different data sources give you different estimates of stock status, and not in a way that makes it clear that any one is inherently superior to another


A few key questions here



- Currently this runs sraplus on all stocks in the region. I think this is informative since it says, suppose we only used sraplus, what would we think, and can compare that to RAM etc. in our heads (or could add a map panel). An alternative though would be to stitch together status, i.e. use RAM where there is RAM, use sraplus otherwise. That would be a better "estimate" of the actual stock status in an area, but would make the contrast between the methods less clear

- This used the continent level Rousseau data - can we get the finer scale version for this paper? Would make things a lot clearer I think 

*will add in RAM panel once I match up RAM stocks to FAO region*

```{r po-map, fig.width=8, fig.height=8, fig.cap="Estimated percent of fisheries 'overfished' (B/B_msy_ less than 0.8) using different dat sources. CPUE refers to an index of abundance based on the Rousseau effort data. Cpue-plus uses CPUE along with fisheries management index (FMI) and/or swept area ratio data. The FAO Report 569 is our reference status estimate provided by the FAO. ram_u_umsy assumes all fisheries in the region share a common U/Umsy series with formally assessed fisheries in the region. fmi uses fmi scores to develop a prior on recent fishing mortality rates, sar does the same but based on swept area ratio."}
po_map_plot
```


## Value of Information

Provide some guidance on where to prioritize data collection. e.g. how long of a CPUE series is needed, expansion of f based priors / value of f, advocate for merging together of the "Catch only" world with the "length-based world". E.g. we talk about catch being the only widely available statistic, but in many data-limited communities all they have are lengths. A global effort to create a centralized database of length distributions could allow for length-based priors on spr/f that could be paired with catches?


# Discussion (500 words)

** how do we know that these assessments themselves aren't actually the right ones"

**address better than nothing**. Certainly not advocating for sitting on hands until better models come around, but important to point out that these models don't just produce noisy but unbiased estimates, they seem to be fundamentally biased in many places. But, no one method appears to be consistently biased (except for catch only)

*these are just rough outline paragraphs*

we do not claim that our model is the best model possible, or that others could not make improvements on our methods. Rather, we claim that any improvements that could be made, given the same data and broadness of scope, would likely be marginal relative to the inherent limitations of the data themselves. 

Global-level assessment are critical for guiding management agendas for the world's oceans. Despite this need, and despite advances in stock assessment methods, our understanding of the world's fisheries remains murky in many parts of the world. Numerous efforts have sought to resolve this problem through development of new modeling methods. These studies have ranged from simple heuristic algorithms to superensemble modeling, but while these studies have advanced our knowledge and motivated important conversations about the state of unassessed fisheries, each has demonstrable shortcomings as an answer for global fisheries assessment. This project was motivated by the need to address this problem, and the increasing availability of broadly (if not globally) datasets that could be of use for fisheries assessment. While we demonstrate that these data can provide value above and beyond the catch histories alone, addition of these data alone does not substantially clarify the picture of global fisheries status.  

Our estimates of global stock status vary wildly depending on which source of data we use. Why not simply pick the best source of data, or use all the available data, and use that to update our estimate of global stock status, under the grounds that that is the best available information? Unfortunately, it is not clear that we can evaluate which source of data provides the best fit; examination of each shows strengths and weakness that are not easily comparable (Fig.\@ref(fig:po-map)). Globally available effort data from Rousseau allows us to create local indices of abundance based on catch histories but carries a host of critical assumptions, namely that the same effort history applies to all fisheries in the region. These CPUE indices are also extremely sensitive to assumptions around rates of change in catchability. The fisheries management index has some ability in predicting stock status (Fig.XX), but out-of-sample testing reveals limitations. Swept-area ratios have a strong relationship with fishing mortality rates, but only for comparable fisheries; it is unclear how good a proxy this measure is for non-demersal stocks. None of these data, or combinations thereof, was able to satisfactorily match the FAO's SOFIA assessments, or the assessments presented in RAM (XX RAM matches? need to add an analysis: match stocks from SOFIA to RAM stocks where possible, plot comparison). 

This is not to say that the data presented here are not valuable. The FMI and SAR based priors are an improvement over catch-only models in applicable situations (i.e. those that sufficiently resemble the data on which the regressions were trained). Effort data such as those reconstructed by @rousseau2019a can help distinguish between regions with similar catch histories but different effort trajectories, and may be quite useful as indices of abundance for areas with relatively constant fishing technologies and a broadly selective fishing fleet. The challenge comes in attempting to indiscriminately apply these data to all areas: doing so results in substantially incorrect estimates of stock status for regions whose nature does not match the assumptions needed to apply these data sources. 

We have stated that improving global estimates of stock status depends on improved data, not improved models *per say*. This is not to suggest that improvements in stock assessment methods, even for relatively simple models such as the biomass dynamics types used here, are not of use. We certainly do not claim that the modeling choices we have made here represent the best version possible. At the tactical level, modeling improvements can make meaningful changes in management outcomes. However, at the global strategic level, the evidence from multiple efforts at assessing global fisheries strongly suggests that any improvements to be made from model improvement are marginal compared to the fundamental uncertainties stemming from currently available data. 

What does the future of global fishery assessment look like? Investment must be made in improving  global data collection and training local fisheries scientists. While the data used in this study were not a silver bullet, they present a step forward, and local versions of these data could prove immensely helpful. Stock-specific, as opposed to the often broad regional estimates used here, estimates of swept-area-ratio and fisheries management index scores can provide improved priors on stock status for applicable fisheries. Informative priors on fishing mortality rates can be particularly useful in improving accuracy of data-limited assessment results (Fig.XX VOI XX)


Our analysis suggests several possible paths for this process, in particular creation of a global repository or length-composition data, and expansion of FMI surveys and SAR data. Global Fishing Watch provides another avenue, but requires further research on the best ways of translating raw effort data into indices of stock status. Interpreting these data responsibly will require support from regional experts, for example in the form of expert panels charged with determine the most representative broadly available data for different portions of the oceans. 

We have accumulated lots of evidence for status of global fisheries, each of which has strengths and weaknesses.These were important foundations. But, if we want to move forwards, the answer is better data. 

# Methods (3000 words)

## `sraplus`

The core of our model is a Pella-Tomlinson [@pella1969] production model parameterzied in the manner of @winker2018. While models of these kinds abstract away many important details of fish biology and fleet behavior, they are the highest resolution model that the potential data evaluated here will support. 

```{r}
cd <- data_frame(Parameter = "Carrying Capacity", Abbreviation = "K", `Default Prior` = "$logn(10\\times{max(catch)},4)$") %>%
  rbind(c("Growth rate", "r", "$logn(r_{fishlife}, \\sigma_{r,fishlife})$")) %>%
  rbind(c("Shape parameter", "m", "$logn(1.01, 0.25)$")) %>%
  rbind(c("Catchability", "q", "$logn(1e^{-3}, 0.3)$")) %>%
  rbind(c("Observation Error", "$\\sigma_{obs}$", "$logn(.05,2)$")) %>%
  rbind(c("Process Error", "$\\sigma_{proc}$", "$logn(.05,0.5)$")) %>% 
  rbind(c("Tech Creep", "$creep$", "$logn(0.025,0.2)$"))

 
knitr::kable(
  cd,
  "latex",
  align = "l",
  booktabs = TRUE,
  escape = F,
  row.names = F,
  caption = "Estimated parameters, abbreviations, and default priors"
) %>%
  kableExtra::kable_styling(full_width = T, font_size = 9) %>%
  kableExtra::row_spec(0, bold = T)
```


The population growth equation is  

\begin{equation}
  f(x)=\begin{cases}
      B_{t + 1} = \left(B_{t} + B_{t}\frac{r}{m - 1}\left(1 - \left(\frac{B_t}{K}\right)^{m- 1}\right) - \hat{c_t}\right)p_t
, & \text{if $B_t>0.25 \times K$}.\\
     B_{t + 1} = \left(B_{t} + \frac{B_{t}}{0.25 \times K}\left(B_{t}\frac{r}{m - 1}\left(1 - \left(\frac{B_t}{K}\right)^{m- 1}\right) - \hat{c_t}\right)\right)p_t, & \text{otherwise}.
  \end{cases}
  (\#eq:hockey)
\end{equation}

Where $B_t$ is biomass at time *t*, *r* is the intrinsic growth rate, *m* is the scaling parameter that allows for the ratio of Bmsy/K to shift (when *m* is 2 the Bmsy / K = 0.5 and the model acts as a Schaefer model, lower values of m shift the production function left, higher values right), *c* is catch, and *p* is process error. The Pella-Tomlinson model does have an issue where growth rates can become unrealistically large when the population reaches low sizes. We deal with this problem by following the methods described in @winker2018 to reduce the production of the population when it falls below a threshold of 25% of carrying capacity. Incorporation of process errors is useful for two reasons: (1) when you have an abundance index, process errors can reduce bias arising from lack of fit in a deterministic SRA whenever dynamics are poorly explained by catch-history alone, and (2) with or without an abundance index (or other info), the stochastic portion is necessary to get good uncertainty intervals (i.e., with close to nominal coverage, see @thorson2018). 

<!-- When the SIR method is used we use the supplied catch history. However, for the maximum likelihood approach, convergence is greatly facilitated by estimating catches ($\hat{c_t}$) rather than using the observed catches directly. $\hat{c_t}$ is given as -->

<!-- \begin{equation} -->
<!--   \hat{c_t} = u_{t}B_{t} -->
<!--   (\#eq:chat) -->
<!-- \end{equation} -->


<!-- where $u_t$ is estimated through -->

<!-- \begin{equation} -->
<!--   u_{t} = \frac{1}{1 + e^{-u^*_t}} -->
<!--   (\#eq:invf) -->
<!-- \end{equation} -->

<!-- Equation \@ref(eq:invf) ensures that $u_t$ is between 0 and 1, while the model estimates $u^*_t$ to improve performance.  -->

<!-- $\hat{c_t}$ is then fit to the observed catches through the likelihood -->

<!-- \begin{equation} -->
<!--   log\left(c_t\right) \sim normal\left(log\left(\hat{c_t}\right),0.05\right) -->
<!--   (\#eq:catch) -->
<!-- \end{equation} -->

<!-- Where we assume an observation coefficient of variation of 5\%. We estimate catch rather than directly using the observed catch in order to improve model performance. As priors on depletion, or indices of abundance, pull the estimated population closer to zero, there is a greater and greater chance that the observed catch history will result in a collapse of the population (catch in time *t* being greater than biomass in time *t*); It is much harder to find parameters that produce a final depletion of 1\% of carrying capacity while not crashing the population prior to then given a catch history, than it is to produce a final depletion of 99\% of carrying capacity. We can impose restrictions and penalties on population crashes, but this distorts the gradients of the model, causing the model to often become stuck once a few crashes have occurred. Since $u_t$ is constrained between 0 and 1, $\hat{c_t}$ will always be "viable", and by then fitting to the observed catches, the model has an easier time finding parameters that produce a near match to the observed catches while not crashing the population. As of now none of the data used in this exercise have missing years of catch data, but the model can handle those cases in the future due to the random walk priors imposed on $u_t$ detailed below.  -->

<!-- In order to help separate out observation error in the catch and process error in the population model, when catch is being estimated we assume that fishing mortality $u_t$ follows a random walk on average, assigning each $u_t$ a prior of -->

<!-- \begin{equation} -->
<!--   log(u_t) \sim normal(log(u_{t - 1}),0.1)) -->
<!--   (\#eq:rwalk) -->
<!-- \end{equation} -->


We  allow for process error [in the manner of the stochastic stock reduction analysis error suggested by @walters2006]. This allows the population dynamics to deviate from the exact values given by the Pella-Tomlinson operating model, while still conforming to the assumptions of this model on average. Process error *p* is assumed to be log-normally distributed, such that 

\begin{equation}
  p_t \sim e^{normal\left(-\sigma_{proc}^2/2,\sigma_{proc}\right)}
  (\#eq:procerror)
\end{equation}


All of our estimates are Bayesian in nature. We can break the use of our model into two distinct categories: with data and without. By "data", we refer to measurements which are confronted with model estimates within a likelihood function. In our context, these include fishery-independent survey data, or a CPUE index. When there are no data, the model amounts to filtering priors through the model (the combination of the Pella-Tomlinson operating model and the catches for the stock in question, along with any fixed parameters). Under this mode, the model is essentially a stock-reduction analysis model, in the manner of @walters2006, in which we ask, which combinations of prior probability distributions of parameters do not crash the population, given the constraints of the model. 

We use a Bayesian methods as it suits the philosophy of our analysis: incorporating prior knowledge about stock status drawn from expert opinion or other similar stocks, and where possible confronting those priors with data. However, this process does introduce a problem, in that it a) certain parts of the prior probability distribution have zero support in the data (e.g. carrying capacity's so small that they crash the population) and b) they create priors on both the *input* (e.g. growth rates and carrying capacity) and *outputs* (recent stock status), effectively putting two prior distributions for the same outcome, a problem termed Borel's Paradox [@puntXX;@rafferty1997]. This may seem like an academic concern, and indeed in our experience when the data are sufficiently informative the Bayesian version of our model subject to Borel's paradox produces effectively identical results to those produce by the same model fit by maximum likelihood. However, particularly for the data-less version of our model, Borel's Paradox poses a particular problem. 

Consider a production model with two parameters, a growth rate *r* and a carrying capacity *k*. Once we specify prior distributions on r and k, and then apply these distributions to our model (the shape of the production function along with the catch histories), we have implicitly provided a prior on the status of the stock in all time periods, since each unique combination of r and k together with the model produces a deterministic stock status in each time step. Suppose then we wish to also provide a prior on stock status in the most recent year, for example to reflect local expert opinion based on sound reasoning. We have now placed two priors on stock status in the most recent year, one implicit and one explicit, violating Borel's Paradox. The net effect of this is that once these priors are run through the model, through for example a sample-importance-resampling (SIR) algorithm as generally applied in stock-reduction analysis, our post-model-pre-data "estimate" of stock status will appear to have "updated". This creates the illusion that we have learned something about stock status, when in fact we have simply used our model to reveal our true implied prior on stock status. This is technically incorrect, since we do not have a likelihood in the model at this point, and as such per Bayes Theorem have not updated our prior. Of more practical importance, this "implied prior" will always reflect a more optimistic stock status then our original prior on stock status, due to the constraints of the population model. 

The SRA algorithm works in two steps. First, the algorithm rejects any draws that resulted in the collapse of the population (biomass less than catch in a given timestep). From there a standard SRA would sample from the priors in proportion to the stated prior on recent stock status, e.g. if the bulk of the prior on terminal stock status was concentrated at 50% of *k*, combinations of *r* and *k* that produce terminal stock status near 50% of *k* are sampled proportionally more frequently. However, lower values of terminal stock status have fewer candidate values of *r* and *k*, since it becomes harder and harder to find viable pairs that come close to but do not crash the population at any time step. Conversely, in the absence of constraints higher values of stock status have infinite combinations of plausible *r* and *k* combinations: since under this model the population cannot be greater than carrying capacity, as for example *k* approaches infinity terminal stock status asymptotes at to 100% of *k*. The net result of this is that even though individual combinations of *r* and *k* that produce higher stock status than the mean of the prior on recent stock status individually have lower probability of being sampled, there are many more opportunities for the lower-probability events that produce higher stock status to be sampled. As a result, the post-model-pre-data prior on terminal depletion will always be higher under this method than the supplied prior on stock status. 

To resolve this, @puntXX (either cite that "on assessment of the bering-chukchi-beufort sea stock of bowhead whales paper that I can't find a date for, or see if he has a new paper on thisXX) suggests a "backwards" fitting approach, in which the model estimates growth parameters and a terminal depletion, and given the model backs out a value of *k* that satisifes the priors (conditional on an assumption initial stock status). We do not adopt this approach here due to computational issues. Adopting the "backwards" approach requires numerically searching for the plausible *k* during each iteration of the model, which is time consuming. In addition, the backwards approach is not without its own complicaitons, for example the requirement of a tolerance around the value of terminal depletion produced by a given *k* and the actual value selected by the model in that time step. This discrepency can occur when a given terminal stock status is not technically possible given the model; to give an extreme example under this model no value of *k* can produce a terminal stock status of 0 if catches are 0 for the entire history of the fishery (assuming *k* > 0). 

We present a novel approximation to this problem here. Our solution amounts to a two-step SIR algorithm. We first run the standard SIR algorithm as described above. We then break the resulting draws into bins based on terminal stock status, and calculate the mean sampling probability of each bin.

$$p(bin_i) = \frac{1}{N_i}\sum_{n = 1}^{N_i}{p(b_{n,i})}$$

We then divide the sampling probability of of bin *i* evenly among each of the draws within that bin *n*

$$p(n_i) = \frac{p(bin_i)}{N_i}$$

And we then perform a second SIR algorithm but now sampling each observation $n_i$ in proportion to $p(n_i)$. The net result of this is a post-model-pre-data distribution of parameters *r* and *k*  that produce a distribution of recent stock status that roughly matches the supplied prior on recent stock status. In effect, this answers the question "given the model, what combinations of parameters produce my prior on recent stock status". 

XX insert figure if there's space illustrating this. 

@raftery1993

## Priors and Data

We briefly describe the construction of priors and nature of available data. All prior regression models where tested by out-of-sample predictive power, and where competing models were considered the final model was chosen by leave-on-out validation [xx citation]. These models are intended as a reasonably robust means of translating available data into usable prior for our model. Given the scope of this analysis, we do not claim that the presented regressions are the best possible model relating these data with fishery status indicators of interest. Rather, each regression was tested to ensure that it is unlike that, given the same data, and alternative model would be unlikely to perform much better than those presented here XX this might be too much defenseXX

For each statistical prior, we fit three different models, relating the data of interesting, e.g. swept area ratio (SAR), to each of *B/B~MSY~*, *F/F~MSY~*, and *F*

## Swept Area Ratio Priors

@amoroso2018 provides an extensive database of trawling footprints throughout the world, including both regions heavily covered by stock assessments and largely unassessed areas. This makes the trawl footprint data an ideal candidate for supporting global stock assessment efforts. As illustrated in @amoroso2018, there is an evident positive relationship between the swept area ratio (SAR,the total annual area trawled divided by the total area of the region) and U/U~MSY~. Note that SAR can be greater than 1 since the same area can be trawled multiple times in a year, e.g. if all trawl-able areas are trawled twice a year then the SAR will be 2. Also note the skewed distribution of SAR values with most concentrated well below 1 and only a handful above 1.

The final selected model relating SAR to to stock status metrics was

$$log(value_i) \sim normal(log(SAR_i) + \frac{catch_i}{max(catch)_i)} + 1,\sigma_{SAR}) $$

XX testing training plot XX

## Fisheries Management Index Priors

The Fisheries Management Index (FMI), as presented in @melnychuk2016, utilizes surveys filled out by regional experts to score a fishery against a set of 46 specific questions for individual species about what elements of fisheries management were in place. These questions are then aggregated into broader categories of science, enforcement, management, and socioeconomics. The higher the score, the better the expert judges that a given metric is met in that fishery. Importantly, FMI surveys can be filled out in the absence of stock assessments. This allows us to explore how FMI values map onto stock status, and explore the ability then to use FMI scores to produce priors on stock status for unassessed fisheries (in a manner similar to @osio2015 and @cope2015). 

The final selected model relating FMI variable to stock status metrics was a generalized additive model (GAM) of the form

$$log(value_i) \sim N(s(research_i) + s(management_i) +
s(enforcement_i) + s(socioeconomics_i) + \frac{catch_i}{max(catch)_i)} + 1,\sigma_{SAR})$$


XX testing training plot XX


## Catch-Only Priors

Many of the current methods for estimating global stock status of unassessed stocks are based on inferring stock status from characteristics of the catch history [@costello2012;@costello2016;@rosenberg2018;@pauly2007]. While these catch-only methods have been shown to have series shortcomings [@free2020], as a point of reference we use two forms of catch-only priors: a statistical and a heuristic approach. 

For the statistical approach, we utilize data from the RAM Legacy Stock Assessment Database to estimate a regression of stock status as a function of catch history characteristics...


For the heuristic approach, we borrow from the original methods of @martell2013 as presented in @andersno2017, and define a heuristic on initial and terminal depletion where

```r
        if (first(catch) / max(catch) < 0.2){
        
        initial_depletion = 0.7
        
        } else {
        
        initial_depletion = 0.4
        
        }
        
        if (last(catch) / max(catch) > 0.5){
        
        terminal_depletion <- 0.6
        
        } else {
        
        terminal_depletion <- 0.2
        
        }
       
```


We also define two statistical regressions relating catch history to stock status. To facilitate the process, we first fit a spectral clustering algorithm to the scaled catch histories of fisheres in RAM, in order identify four possible clusters of catch history types within the the data. Emergent clusters show for example one build around "one way trip" style catch histories, others with a boom and bust, etc. 

We then trained a classification algorithm to predict which catch cluster a given fishery would fall into based on the shape of its catch history. This algorithm was then used to assign fisheries to one of the four identified catch history types, and the catch history type was then used as a hierarchical term within our catch-based regressions (where *s* refers to a smoothing term). For the first regression, we restrict the data to the first year of data available for each fishery *i*, in order to estimate initial stock status

$$log(value_i) \sim normal(s(\frac{first(catch)}{max(catch)} | cluster_i) + s(log(lengthi)|cluster_i) + 1, \sigma) $$

For the second regression, we included data for all available years *y* for fishery *i*. The model is then used to construct a prior on fishery status in the terminal year of the data

$$log(value_{i,y}) \sim normal(s(fyear | cluster_i) + s(\frac{catch_{i,y}}{max(catch_i)} | cluster_i) + cluster_i, \sigma)$$
where *fyear* is the year of the fishery, starting from 0. 


## Effort Data

While the FMI and SAR data show some potential for estimating U/U~MSY~ and B/B~MSY~ values, they are clearly not an ideal measure of stock status. An alternative is to actually develop indices of abundance that we can fit models to. @rousseau2019 provides a useful starting place for this exercise, presenting estimates of fishing effort throughout the globe from 1950 to 2015.  Merging these data with capture statistics can provide a crude CPUE index that can then be used to fit a surplus production model. Developing an index of abundance in this manner is clearly a very rough analysis only intended to illustrate broad concepts. Any analysis of CPUE data can be severely affected by changes in technology, skill, hyperdepletion, hyperstability, changes in the spatial footprint of the fishery, and selectivity [@maunder2004a; @walters2003]. In the case of this analysis, a kilowatt day of fishing with 1950s technology clearly represents a different amount of fishing power than a kilowatt day of fishing in 2012. To account for this somewhat, @rousseau2019 include a 2.6% annual "technological creep" factor, which we incorporate in our analysis. 

@rousseau2019 measure an index of abundance as catch divided by their effort index, either nominal or effective (assuming the 2.6\% technology rate). This assumes that every unit increase in effort is linearly greater than the unit of effort before it. When effort increases dramatically above historic levels, this can create a CPUE index that decreases faster than the true population. This is due to the fact that the marginal fishing mortality produced by increasing unit of efforts increases decreases as effort approaches infinity (since fishing mortality is bounded between 0 and 1). To accomodate this, we generate a catch per effective harvest rate index of abundance, as

$$I_t = \frac{catch_t}{(1 - e^{-q_tE_t})}$$

Where $q_t$ can has a technology rate component $\tau$

$$q_t = q_{t-1} \times (1  + \tau)$$


## Value of Information Calculations

Details of value of information calculates (fitting to messed up versions of RAM)


# References

